/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	__webpack_require__(1);
	__webpack_require__(2);
	__webpack_require__(3);
	__webpack_require__(4); 
	
	__webpack_require__(5);
	//require('./js/prefabs/Blueprints/HouseBp.js');        
	//require('./js/prefabs/Blueprints/MiningPoint.js');
	
	
	__webpack_require__(6);
	__webpack_require__(7);
	__webpack_require__(8);
	
	__webpack_require__(9);
	__webpack_require__(10);
	__webpack_require__(11);
	__webpack_require__(12);
	__webpack_require__(13);
	__webpack_require__(14);
	__webpack_require__(15);
	__webpack_require__(16);
	__webpack_require__(17);
	__webpack_require__(18);
	
	     
	__webpack_require__(19);
	__webpack_require__(20);
	__webpack_require__(21);
	
	__webpack_require__(22);

/***/ },
/* 1 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.Prefab = function (game_state, name, position, properties) {
	    "use strict";
	    Phaser.Sprite.call(this, game_state.game, position.x, position.y, properties.texture);
	    
	    this.game_state = game_state;
	    
	    this.name = name;
	    
	    this.game_state.groups[properties.group].add(this);
	    this.frame = +properties.frame;
	    
	    if (properties.scale) {
	        this.scale.setTo(properties.scale.x, properties.scale.y);
	    }
	    
	    this.game_state.prefabs[name] = this;
	};
	
	Muryoma.Prefab.prototype = Object.create(Phaser.Sprite.prototype);
	Muryoma.Prefab.prototype.constructor = Muryoma.Prefab;
	
	Muryoma.Prefab.prototype.render = function(){
	    //"use strict";    
	    //game.debug.body(this);    
	};
	


/***/ },
/* 2 */
/***/ function(module, exports) {

	console.log('TilePrefab');
	var Muryoma = Muryoma || {};
	
	Muryoma.TilePrefab = function (game_state, name, position, properties) {
	    "use strict";
	    Phaser.TileSprite.call(this, game_state.game, position.x, position.y, properties.width, properties.height, properties.texture);
	    
	    this.game_state = game_state;
	    
	    this.name = name;
	    
	    this.game_state.groups[properties.group].add(this);
	    this.frame = +properties.frame;
	    
	    this.game_state.prefabs[name] = this;
	};
	
	Muryoma.TilePrefab.prototype = Object.create(Phaser.TileSprite.prototype);
	Muryoma.TilePrefab.prototype.constructor = Muryoma.TilePrefab;

/***/ },
/* 3 */
/***/ function(module, exports) {

	console.log('TextPrefab');
	var Muryoma = Muryoma || {};
	
	Muryoma.TextPrefab = function (game_state, name, position, properties) {
	    "use strict";
	    Phaser.Text.call(this, game_state.game, position.x, position.y, properties.text, properties.style);
	    
	    this.game_state = game_state;
	    
	    this.name = name;
	    
	    this.game_state.groups[properties.group].add(this);
	    
	    this.game_state.prefabs[name] = this;
	};
	
	Muryoma.TextPrefab.prototype = Object.create(Phaser.Text.prototype);
	Muryoma.TextPrefab.prototype.constructor = Muryoma.TextPrefab;

/***/ },
/* 4 */
/***/ function(module, exports) {

	console.log('Utils');
	var Muryoma = Muryoma || {};
	
	Muryoma.create_prefab_from_pool = function (pool, prefab_constructor, game_state, prefab_name, prefab_position, prefab_properties) {
	    "use strict";
	    var prefab;
	    // get the first dead prefab from the pool
	    prefab = pool.getFirstDead();
	    if (!prefab) {
	        // if there is no dead prefab, create a new one
	        prefab = new prefab_constructor(game_state, prefab_name, prefab_position, prefab_properties);
	    } else {
	        // if there is a dead prefab, reset it in the new position
	        prefab.reset(prefab_position.x, prefab_position.y);
	    }
	};

/***/ },
/* 5 */
/***/ function(module, exports) {

	console.log('Blueprint');
	var Muryoma = Muryoma || {};
	console.log("Muryoma ", Muryoma);
	
	Muryoma.Blueprint = function (game_state, name, position, properties) {
	    "use strict";
	    Muryoma.Prefab.call(this, game_state, name, position, properties);    
	    this.stats = properties.stats;
	    this.inputEnabled = true;
	    this.events.onInputOver.add(this.inputOver, this);
	    this.events.onInputOut.add(this.inputOut, this);
	    this.events.onInputDown.add(this.onInputDown, this);
	};
	
	Muryoma.Blueprint.prototype = Object.create(Muryoma.Prefab.prototype);
	Muryoma.Blueprint.prototype.constructor = Muryoma.Blueprint;
	
	Muryoma.Blueprint.prototype.restore_tint = function () {
	    "use strict";
	    this.tint = 0xFFFFFF;
	};
	
	Muryoma.Blueprint.prototype.inputOver = function() {
	    "use strict";
	    console.log('BP inputOver');
	};
	
	Muryoma.Blueprint.prototype.inputOut = function() {
	    "use strict";
	    console.log('BP inputOut');
	};
	
	Muryoma.Blueprint.prototype.onInputDown = function() {
	    "use strict";
	    console.log('onInputDown');
	};


/***/ },
/* 6 */
/***/ function(module, exports) {

	console.log('Building');
	var Muryoma = Muryoma || {};
	
	Muryoma.Building = function (game_state, name, position, properties) {
	    "use strict";
	    Muryoma.Prefab.call(this, game_state, name, position, properties);   
	    this.inputEnabled = true;  
	    this.enableBody = true;      
	    
	    //this.events.onInputOver.add(this.inputOver, this);
	    //this.events.onInputOut.add(this.inputOut, this);
	    //this.events.onInputDown.add(this.onInputDown, this);
	};
	
	Muryoma.Building.prototype = Object.create(Muryoma.Prefab.prototype);
	Muryoma.Building.prototype.constructor = Muryoma.Building;
	
	Muryoma.Building.prototype.inputOver = function() {
	    "use strict";
	    console.log('Building inputOver');
	};
	
	Muryoma.Building.prototype.inputOut = function() {
	    "use strict";
	    console.log('Building inputOut');
	};
	
	Muryoma.Building.prototype.onInputDown = function() {
	    "use strict";
	    console.log('Building onInputDown');
	};
	
	console.log('Building2');
	


/***/ },
/* 7 */
/***/ function(module, exports) {

	console.log('MenuItem');
	var Muryoma = Muryoma || {};
	
	Muryoma.MenuItem = function (game_state, name, position, properties) {
	    "use strict";    
	    Muryoma.TextPrefab.call(this, game_state, name, position, properties);
	    
	    this.inputEnabled = true;
	    //this.events.onInputOver.add(this.inputOver, this);
	    //this.events.onInputOut.add(this.inputOut, this);
	    //this.events.onInputDown.add(this.onInputDown, this);    
	};
	
	Muryoma.MenuItem.prototype = Object.create(Muryoma.TextPrefab.prototype);
	Muryoma.MenuItem.prototype.constructor = Muryoma.MenuItem;
	
	Muryoma.MenuItem.prototype.selection_over = function () {
	    "use strict";
	    this.fill = "#FFFF00";
	};
	
	Muryoma.MenuItem.prototype.selection_out = function () {
	    "use strict";
	    this.fill = "#FFFFFF";
	};
	/*
	Muryoma.MenuItem.prototype.inputOver = function() {
	    "use strict";
	    console.log('inputOver');
	};
	
	Muryoma.MenuItem.prototype.inputOut = function() {
	    "use strict";
	    console.log('inputOut');
	  
	};
	*/
	Muryoma.MenuItem.prototype.onInputDown = function() {
	    "use strict";
	    //console.log('onInputDown');
	    //console.log('game_state ', this.parent);    
	};


/***/ },
/* 8 */
/***/ function(module, exports) {

	console.log('Menu');
	
	var Muryoma = Muryoma || {};
	
	Muryoma.Menu = function (game_state, name, position, properties) {
	    "use strict";    
	    var live_index, life;
	    Muryoma.Prefab.call(this, game_state, name, position, properties);
	    
	    this.visible = false;    
	    this.menu_items = properties.menu_items;    
	    this.current_item_index = 0; 
	    
	};
	
	Muryoma.Menu.prototype = Object.create(Muryoma.Prefab.prototype);
	Muryoma.Menu.prototype.constructor = Muryoma.Menu;
	
	Muryoma.Menu.prototype.process_input = function (event) {    
	    //console.log('menu process_input ', event.keyCode);
	    "use strict";
	    switch (event.keyCode) {
	    case Phaser.Keyboard.UP:
	        if (this.current_item_index > 0) {
	            // navigate to previous item
	            this.move_selection(this.current_item_index - 1);
	        }
	        break;
	    case Phaser.Keyboard.DOWN:
	        if (this.current_item_index < this.menu_items.length - 1) {
	            // navigate to next item
	            this.move_selection(this.current_item_index + 1);
	        }
	        break;
	    case Phaser.Keyboard.SPACEBAR:
	        this.menu_items[this.current_item_index].select();
	        break;
	    }   
	};
	
	Muryoma.Menu.prototype.update = function (item_index) {
	    "use strict";
	};
	
	
	Muryoma.Menu.prototype.move_selection = function (item_index) {
	    "use strict";
	    this.menu_items[this.current_item_index].selection_out();
	    this.current_item_index = item_index;
	    this.menu_items[this.current_item_index].selection_over();
	};
	
	Muryoma.Menu.prototype.find_item_index = function (text) {
	    "use strict";
	    var item_index;
	    for (item_index = 0; item_index < this.menu_items.length; item_index += 1) {
	        if (this.menu_items[item_index].text === text) {
	            return item_index;
	        }
	    }
	};
	
	Muryoma.Menu.prototype.remove_item = function (index) {
	    "use strict";
	    var menu_item;
	    menu_item = this.menu_items[index];
	    // remove menu item
	    this.menu_items.splice(index, 1);
	    // update current_item_index if necessary
	    if (this.current_item_index === index) {
	        this.current_item_index = 0;
	    }
	    return menu_item;
	};
	
	Muryoma.Menu.prototype.enable = function () {    
	    "use strict";
	    this.current_item_index = 0;
	    if (this.menu_items.length > 0) {
	        this.menu_items[this.current_item_index].selection_over();
	    }
	    
	    this.game_state.game.input.keyboard.addCallbacks(this, this.process_input);    
	};
	
	Muryoma.Menu.prototype.disable = function () {
	    "use strict";
	    /*
	    "use strict";
	    if (this.menu_items.length > 0) {
	        this.menu_items[this.current_item_index].selection_out();
	    }
	    this.current_item_index = 0;
	    */
	};

/***/ },
/* 9 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.EnemyMenuItem = function (game_state, name, position, properties) {
	    "use strict";
	    Muryoma.MenuItem.call(this, game_state, name, position, properties);
	};
	
	Muryoma.EnemyMenuItem.prototype = Object.create(Muryoma.MenuItem.prototype);
	Muryoma.EnemyMenuItem.prototype.constructor = Muryoma.EnemyMenuItem;
	
	Muryoma.EnemyMenuItem.prototype.select = function () {
	    "use strict";
	    var enemy;
	    // get enemy prefab
	    enemy = this.game_state.prefabs[this.text];
	    // attack selected enemy
	    this.game_state.current_unit.attack(enemy);
	    // disable menus
	    this.game_state.prefabs.enemy_units_menu.disable();
	    this.game_state.prefabs.player_units_menu.disable();
	};

/***/ },
/* 10 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.PlayerMenuItem = function (game_state, name, position, properties) {
	    "use strict";
	    Muryoma.MenuItem.call(this, game_state, name, position, properties);
	    
	    this.player_unit_health = new Muryoma.ShowStat(this.game_state, this.text + "_health", {x: 280, y: this.y}, {group: "hud", text: "", style: properties.style, prefab: this.text, stat: "health"});
	};
	
	Muryoma.PlayerMenuItem.prototype = Object.create(Muryoma.MenuItem.prototype);
	Muryoma.PlayerMenuItem.prototype.constructor = Muryoma.PlayerMenuItem;
	
	Muryoma.PlayerMenuItem.prototype.select = function () {
	    "use strict";
	};

/***/ },
/* 11 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.AttackMenuItem = function (game_state, name, position, properties) {
	    "use strict";
	    Muryoma.MenuItem.call(this, game_state, name, position, properties);
	};
	
	Muryoma.AttackMenuItem.prototype = Object.create(Muryoma.MenuItem.prototype);
	Muryoma.AttackMenuItem.prototype.constructor = Muryoma.AttackMenuItem;
	
	Muryoma.AttackMenuItem.prototype.select = function () {
	    "use strict";
	    // disable actions menu
	    this.game_state.prefabs.actions_menu.disable();
	    // enable enemy units menu so the player can choose the target
	    this.game_state.prefabs.enemy_units_menu.enable();
	};

/***/ },
/* 12 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.BuildArea = function (game_state, layer) {
	    "use strict";
	
	    var name = 'build_area';    
	    var position = {x: 0, y: 0};
	    var height = 584;
	    var width = 1024;
	
	    // create a new bitmap data object
	    var bmd = game.add.bitmapData(width,height);   
	    
	    this.marker = new Muryoma.Marker(game_state, layer);
	
	    // draw to the canvas context like normal
	    bmd.ctx.beginPath();
	    bmd.ctx.rect(0,0,width,height);
	    //debug
	    //bmd.ctx.fillStyle = '#0B486B';        
	    //bmd.ctx.fill();
	
	    var properties = {group: 'hud', width: width, height: height, texture: bmd};
	
	    Muryoma.Prefab.call(this, game_state, name, position, properties);    
	
	    this.inputEnabled = true;
	    this.input.enableSnap(32, 32, false, true);
	    this.events.onInputOver.add(this.inputOver, this);
	    this.events.onInputOut.add(this.inputOut, this);
	    this.events.onInputDown.add(this.onInputDown, this);  
	};
	
	Muryoma.BuildArea.prototype = Object.create(Muryoma.Prefab.prototype);
	Muryoma.BuildArea.prototype.constructor = Muryoma.BuildArea;
	
	Muryoma.BuildArea.prototype.restore_tint = function () {
	    "use strict";
	    this.tint = 0xFFFFFF;
	};
	
	Muryoma.BuildArea.prototype.inputOver = function() {
	    "use strict";
	    /*
	    console.log('BuildArea inputOver');    
	    console.log('this.marker ', this.marker);
	    console.log('hud group ', this.game_state.groups.hud.children);
	    */
	    this.marker.visible = true;      
	};
	
	Muryoma.BuildArea.prototype.inputOut = function() {
	    "use strict";
	    console.log('BuildArea inputOut');    
	    this.marker.visible = false;  
	};
	
	Muryoma.BuildArea.prototype.onInputDown = function() {
	    "use strict";    
	    var childArray = this.game_state.groups.hud.children;    
	    var hud_menu = childArray.filter(function(a){ return a.name == 'hud_menu' })[0];        
	    var marker = childArray.filter(function(a){ return a.name == 'marker' })[0];
	
	    game.physics.arcade.enable([marker, this.game_state.groups.buildings]);    
	    var cBuildings = game.physics.arcade.collide(marker, this.game_state.groups.buildings, function(sprite1, sprite2){                      
	       return true;
	    });  
	
	    var cbp = hud_menu.current_blueprint; 
	    console.log('current_blueprint ', hud_menu.current_blueprint);
	    if(cbp && !cBuildings){
	        var x = layer.getTileX(game.input.activePointer.worldX) * 32;
	        var y = layer.getTileY(game.input.activePointer.worldY) * 32; 
	        var properties = {group:'buildings', texture: cbp.texture};   
	        new Muryoma.Building(this.game_state, cbp.key, {x:x, y:y}, properties);         
	        //hud_menu.current_blueprint = null;
	        //marker.kill();        
	    }   
	    
	};
	
	
	
	
	


/***/ },
/* 13 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.BlueprintMenu = function (game_state, name, position, properties) {
	    "use strict";
	    /*
	    console.log('---------------------');
	    console.log('game_state ', game_state);
	    console.log('name ', name);
	    console.log('position ', position);
	    */
	    
	    var live_index, life;
	    Muryoma.Prefab.call(this, game_state, name, position, properties);    
	    this.blueprintMenu_items = properties.menu_items;    
	    this.current_blueprint = null;   
	    this.colorDisabled();   
	};
	
	Muryoma.BlueprintMenu.prototype = Object.create(Muryoma.Prefab.prototype);
	Muryoma.BlueprintMenu.prototype.constructor = Muryoma.BlueprintMenu;
	
	Muryoma.BlueprintMenu.prototype.update = function (item_index) {
	    "use strict";    
	};
	
	Muryoma.BlueprintMenu.prototype.setCurrentBlueprint = function (blueprint) {
	    "use strict";    
	    console.log('setCurrentBlueprint ', blueprint);
	    
	    this.current_blueprint = blueprint;
	    var childArray = this.game_state.groups.hud.children;    
	    var marker = childArray.filter(function(a){ return a.name == 'marker' })[0];
	    marker.setDimensions(blueprint);
	    this.colorDisabled();
	    blueprint.tint = 0xFFFFFF;
	};
	
	Muryoma.BlueprintMenu.prototype.colorDisabled = function(){
	    "use strict";    
	    for (var i = this.blueprintMenu_items.length - 1; i >= 0; i--) {
	        this.blueprintMenu_items[i].tint = 0x75757;
	    };
	};

/***/ },
/* 14 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.BlueprintMenuItem = function (game_state, name, position, properties) {
	    "use strict";
	    /*
	    console.log('BlueprintMenuItem ---------------------');    
	    console.log('name ', name);
	    console.log('position ', position);
	    console.log('properties ', properties);
	    */
	
	    Muryoma.Prefab.call(this, game_state, name, position, properties);
	
	    this.inputEnabled = true;
	    //this.events.onInputOver.add(this.inputOver, this);
	    //this.events.onInputOut.add(this.inputOut, this);
	    this.events.onInputDown.add(this.onInputDown, this);
	    this.height = 64;
	    this.width = 64;
	};
	
	Muryoma.BlueprintMenuItem.prototype = Object.create(Muryoma.Prefab.prototype);
	Muryoma.BlueprintMenuItem.prototype.constructor = Muryoma.BlueprintMenuItem;
	
	Muryoma.BlueprintMenuItem.prototype.select = function () {
	    "use strict";
	    console.log('BlueprintMenuItem selected');
	    /*
	    var enemy;
	    // get enemy prefab
	    enemy = this.game_state.prefabs[this.text];
	    // attack selected enemy
	    this.game_state.current_unit.attack(enemy);
	    // disable menus
	    this.game_state.prefabs.enemy_units_menu.disable();
	    this.game_state.prefabs.player_units_menu.disable();
	    */
	};
	
	Muryoma.BlueprintMenuItem.prototype.onInputDown = function (){
	    console.log('BlueprintMenuItem clicked: ', this.name);     
	    this.game_state.prefabs.hud_menu.setCurrentBlueprint(this);
	};

/***/ },
/* 15 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.ShowStat = function (game_state, name, position, properties) {
	    "use strict";
	    Muryoma.TextPrefab.call(this, game_state, name, position, properties);
	    
	    this.prefab = this.game_state.prefabs[properties.prefab];
	    this.stat = properties.stat;
	};
	
	Muryoma.ShowStat.prototype = Object.create(Muryoma.TextPrefab.prototype);
	Muryoma.ShowStat.prototype.constructor = Muryoma.ShowStat;
	
	Muryoma.ShowStat.prototype.update = function () {
	    "use strict";
	    this.text = this.prefab.stats[this.stat];
	};

/***/ },
/* 16 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.ActionMessage = function (game_state, name, position, properties) {
	    "use strict";
	    Muryoma.Prefab.call(this, game_state, name, position, properties);
	    
	    this.anchor.setTo(0.5);
	    
	    // create message text
	    this.message_text = new Muryoma.TextPrefab(this.game_state, this.name + "_message", position, {group: "hud", text: properties.message, style: Object.create(this.game_state.TEXT_STYLE)});
	    this.message_text.anchor.setTo(0.5);
	    
	    // start timer to destroy the message
	    this.kill_timer = this.game_state.game.time.create();
	    this.kill_timer.add(Phaser.Timer.SECOND * properties.duration, this.kill, this);
	    this.kill_timer.start();
	};
	
	Muryoma.ActionMessage.prototype = Object.create(Muryoma.Prefab.prototype);
	Muryoma.ActionMessage.prototype.constructor = Muryoma.ActionMessage;
	
	Muryoma.ActionMessage.prototype.kill = function () {
	    "use strict";
	    Phaser.Sprite.prototype.kill.call(this);
	    // when the message is destroyed, call next turn
	    this.message_text.kill();
	    this.game_state.next_turn();
	};

/***/ },
/* 17 */
/***/ function(module, exports) {

	    /* Marker */
	    /* ---------------------------------------------------------------------------------------- */
	    
	
	    var Muryoma = Muryoma || {};
	
	    Muryoma.Marker = function (game_state, layer) {
	        "use strict";
	
	        var name = 'marker';    
	        var position = {x: 0, y: 0};
	        var height = 64;
	        var width = 64;
	        
	        // create a new bitmap data object
	        var bmd = game.add.bitmapData(width,height);
	
	        // draw to the canvas context like normal
	        bmd.ctx.beginPath();
	        bmd.ctx.rect(0,0,width,height);
	        //debug
	        //bmd.ctx.fillStyle = '#EACADD';      
	        //bmd.ctx.fill();
	
	        var properties = {group: 'hud', width: width, height: height, texture: bmd};
	
	        Muryoma.Prefab.call(this, game_state, name, position, properties);       
	        this.inputEnabled = true; 
	        this.input.boundsRect = layer;
	        this.input.enableSnap(32, 32, true, true);
	        this.enableBody = true;            
	    };
	
	    Muryoma.Marker.prototype = Object.create(Muryoma.Prefab.prototype);
	    Muryoma.Marker.prototype.constructor = Muryoma.Marker;
	    Muryoma.Marker.prototype.update = function(){   
	        this.x = layer.getTileX(game.input.activePointer.worldX) * 32;
	        this.y = layer.getTileY(game.input.activePointer.worldY) * 32;                
	    };
	
	    Muryoma.Marker.prototype.collisionHandler = function(sprite1, sprite2){         
	        console.log('collision ', sprite1);            
	    }
	
	    Muryoma.Marker.prototype.setDimensions = function(blueprint){
	        //console.log('blueprint ', blueprint);
	        this.texture = blueprint.texture;        
	        this.body = blueprint.body;       
	        this.alpha = 0.5;
	    }
	    /* ---------------------------------------------------------------------------------------- */


/***/ },
/* 18 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.StatManager = function (game_state, name, position, properties) {
	    "use strict";
	    Muryoma.Prefab.call(this, game_state, name, position, properties);    
	    this.visible = false; 
	  	var data = [];
	
	    this.mydata = game.add.text(position.x, position.y, '', Object.create(game_state.TEXT_STYLE));
	    this.mydata.parseList(data);
	
	    game.time.events.loop(Phaser.Timer.SECOND, updateCounter, this);
	    this.counter = 0;
	
	
	    this.population = 0; //total population
	    this.supplySpace = 0; //space needed for the population
	
	};
	
	function updateCounter() {
	    this.counter++;    
	}
	
	Muryoma.StatManager.prototype = Object.create(Muryoma.TextPrefab.prototype);
	Muryoma.StatManager.prototype.constructor = Muryoma.StatManager;
	
	Muryoma.StatManager.prototype.update = function () {
	    "use strict"; 
	
	    var data = [
	    	[ 'Time', this.counter , '', '' ],        
	        [ 'Population', this.population, '', '' ],
	        [ 'Supply', this.supplySpace, '', '' ],        
	        
	    ];
	   this.mydata.parseList(data);
	};
	


/***/ },
/* 19 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.BootState = function () {
	    "use strict";
	    Phaser.State.call(this);
	};
	
	Muryoma.BootState.prototype = Object.create(Phaser.State.prototype);
	Muryoma.BootState.prototype.constructor = Muryoma.BootState;
	
	Muryoma.BootState.prototype.init = function (level_file, next_state) {
	    "use strict";
	    this.level_file = level_file;
	    this.next_state = next_state;
	};
	
	Muryoma.BootState.prototype.preload = function () {
	    "use strict";
	    this.load.text("level1", this.level_file);
	};
	
	Muryoma.BootState.prototype.create = function () {
	    "use strict";
	    var level_text, level_data;
	    level_text = this.game.cache.getText("level1");
	    level_data = JSON.parse(level_text);    
	    this.game.state.start("LoadingState", true, false, level_data, this.next_state);
	};

/***/ },
/* 20 */
/***/ function(module, exports) {

	var Muryoma = Muryoma || {};
	
	Muryoma.LoadingState = function () {
	    "use strict";
	    Phaser.State.call(this);
	};
	
	Muryoma.LoadingState.prototype = Object.create(Phaser.State.prototype);
	Muryoma.LoadingState.prototype.constructor = Muryoma.LoadingState;
	
	Muryoma.LoadingState.prototype.init = function (level_data, next_state) { 
	
	    "use strict";
	    this.level_data = level_data;
	    this.next_state = next_state;
	};
	
	Muryoma.LoadingState.prototype.preload = function () {
	    "use strict";
	    var assets, asset_loader, asset_key, asset;
	    assets = this.level_data.assets;
	    for (asset_key in assets) { // load assets according to asset key
	        if (assets.hasOwnProperty(asset_key)) {
	            asset = assets[asset_key];
	            switch (asset.type) {
	            case "image":
	                this.load.image(asset_key, asset.source);
	                break;
	            case "spritesheet":
	                this.load.spritesheet(asset_key, asset.source, asset.frame_width, asset.frame_height, asset.frames, asset.margin, asset.spacing);
	                break;
	            case "tilemap":
	                this.load.tilemap(asset_key, asset.source, null, Phaser.Tilemap.TILED_JSON);
	                break;
	            }
	        }
	    }
	};
	
	Muryoma.LoadingState.prototype.create = function () {
	    "use strict";
	    this.game.state.start(this.next_state, true, false, this.level_data);
	};

/***/ },
/* 21 */
/***/ function(module, exports) {

	console.log('ManageState');
	var Muryoma = Muryoma || {};
	
	Muryoma.ManageState = function () {
	    "use strict";
	    Phaser.State.call(this);
	    
	    this.prefab_classes = {
	        "background": Muryoma.TilePrefab.prototype.constructor,
	        "rectangle": Muryoma.Prefab.prototype.constructor,        
	        "blueprint": Muryoma.Blueprint.prototype.constructor
	    };
	    
	    this.TEXT_STYLE = {font: "14px Arial", fill: "#9a7b6e"};
	
	    this.SHORT_TIME = 3000;
	    this.MEDIUM_TIME = this.SHORT_TIME * 2;
	    this.LONG_TIME = tMEDIUM_TIME * 2;
	};
	
	Muryoma.ManageState.prototype = Object.create(Phaser.State.prototype);
	Muryoma.ManageState.prototype.constructor = Muryoma.ManageState;
	
	Muryoma.ManageState.prototype.init = function (level_data) {
	    //console.log('----------------');
	    //console.log('ManageState init');
	    
	    "use strict";
	    this.level_data = level_data;    
	    this.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;
	    this.scale.pageAlignHorizontally = true;
	    this.scale.pageAlignVertically = true;
	};
	
	Muryoma.ManageState.prototype.create = function () {
	    //console.log('----------------');
	    //console.log('ManageState create');   
	
	    "use strict";
	    var group_name, prefab_name, player_unit_name, enemy_unit_name, layer, buildings;
	    
	    this.show_background();
	    
	
	    // create groups
	    this.groups = {};
	    this.level_data.groups.forEach(function (group_name) {        
	        this.groups[group_name] = this.game.add.group();
	    }, this);  
	
	    // create prefabs
	    this.prefabs = {};
	    for (prefab_name in this.level_data.prefabs) {        
	        if (this.level_data.prefabs.hasOwnProperty(prefab_name)) {
	            // create prefab
	            this.create_prefab(prefab_name, this.level_data.prefabs[prefab_name]);
	        }
	    };    
	
	    //this.add_mining_points();
	    
	    this.init_hud();    
	    // create units array with player and enemy units
	    this.units = [];
	    //this.units = this.units.concat(this.groups.player_units.children);
	    //this.units = this.units.concat(this.groups.enemy_units.children);
	    this.units = this.units.concat(this.groups.hud.children);        
	    //this.next_turn();
	};
	
	Muryoma.ManageState.prototype.create_prefab = function (prefab_name, prefab_data) {
	    "use strict";
	    /*
	    console.log('----------------');
	    console.log('ManageState create');
	    console.log('prefab_name ', prefab_name);
	    console.log('prefab_data ', prefab_data);
	    */    
	
	    var prefab;
	    // create object according to its type
	    if (this.prefab_classes.hasOwnProperty(prefab_data.type)) {
	        prefab = new this.prefab_classes[prefab_data.type](this, prefab_name, prefab_data.position, prefab_data.properties);
	    }
	};
	
	Muryoma.ManageState.prototype.init_hud = function () {
	    "use strict";
	    var unit_index, player_unit_health, build_area, stat_manager;
	
	    // show player actions
	    //this.show_player_actions({x: 106, y: 210});
	    
	    // show player units
	    //this.show_units("player_units", {x: 202, y: 210}, Muryoma.PlayerMenuItem.prototype.constructor);
	    
	    // show enemy units
	    //this.show_units("enemy_units", {x: 10, y: 210}, Muryoma.EnemyMenuItem.prototype.constructor);  
	
	    // show blueprints
	    this.show_blueprints("hud", {x: 10, y: 660}, Muryoma.BlueprintMenuItem.prototype.constructor);
	    //this.create_stats("hud", {x: 290, y: 665}, Muryoma.BlueprintMenuItem.prototype.constructor);
	    stat_manager = new Muryoma.StatManager(this, "stat_manager", {x: 290, y: 665}, {group: "hud"})
	    build_area = new Muryoma.BuildArea(this, layer);      
	
	};
	
	Muryoma.ManageState.prototype.show_blueprints = function (group_name, position, menu_item_constructor) {    
	    "use strict";    
	
	    //console.log('---------------------');
	    //console.log('group_name ', group_name);
	    //console.log('this.groups ', this.groups);
	    var bp_index, menu_items, bp_menu_item, bp_menu;
	    
	    bp_index = 0;
	    menu_items = []; 
	
	    for (var key in this.level_data.bp) {
	        var item = this.level_data.bp[key];
	        bp_menu_item = new menu_item_constructor(this, key + "_menu_item", {x: position.x + bp_index * 80, y: position.y + 5}, {group: "hud", text: key, texture: item.properties.texture});
	        bp_index += 1;
	        menu_items.push(bp_menu_item);
	    }  
	
	    bp_menu = new Muryoma.BlueprintMenu(this, group_name + "_menu", position, {group: "hud", menu_items: menu_items});    
	    
	};
	
	Muryoma.ManageState.prototype.show_background = function() {
	    
	   var map;
	   var data = '';  
	
	    for (var y = 0; y < 50; y++){
	        for (var x = 0; x < 50; x++){
	            //data += this.game.rnd.between(0, 4).toString();
	            data += 0 //underdark
	            if (x < 49){
	                data += ',';
	            }
	        }
	        if (y < 49){
	            data += "\n";
	        }
	    }                  
	
	    this.game.cache.addTilemap('dynamicMap', null, data, Phaser.Tilemap.CSV);
	
	    //  Create our map (the 32x32 is the tile size)        
	    map = this.game.add.tilemap('dynamicMap', 32, 32);
	
	    //  'tiles' = cache image key, 32x32 = tile size
	    //map.addTilesetImage('ground_1x1', 'ground_1x1', 32, 32);
	    map.addTilesetImage('darkcave', 'darkcave', 32, 32);
	
	    //  0 is important
	    //layer = map.createLayer(0);  
	    layer = map.createLayer(0, 1024, 648);  
	    layer.resizeWorld();
	};
	
	
	Muryoma.ManageState.prototype.add_mining_points = function(){
	
	    /* const */
	    var NR_MINING_POINTS = 5;    
	    var WORLD_HEIGHT = 800;
	    var WORLD_WIDTH = 600;
	
	    /* Mining points */
	    
	    var resources = this.game.add.physicsGroup(Phaser.Physics.ARCADE);
	    console.log('gamestate ', this);
	    this.groups['resources'] = resources;
	
	    
	    var i, x, y;
	    for(i = 0; i < NR_MINING_POINTS; i++) {            
	        x = randStep(0, WORLD_WIDTH - 96, 32);    
	        y = randStep(0, WORLD_HEIGHT - 192 , 32);       
	        new Muryoma.MiningPoint(this, {x: x, y: y});
	
	    }  
	    resources.setAll('body.collideWorldBounds', true);  
	    resources.setAll('body.immovable', true);
	    
	    /* get random number at definite step, used for grid coordinates at step of 32px*/        
	    function randStep(min, max, step) {
	        return min + (step * Math.floor(Math.random()*(max-min)/step) );
	    }
	
	}
	
	
	Muryoma.ManageState.prototype.show_units = function (group_name, position, menu_item_constructor) {
	    /*
	    "use strict";
	    var unit_index, menu_items, unit_menu_item, units_menu;
	
	    // create units menu items
	    unit_index = 0;
	    menu_items = [];
	    this.groups[group_name].forEach(function (unit) {
	        unit_menu_item = new menu_item_constructor(this, unit.name + "_menu_item", {x: position.x, y: position.y + unit_index * 20}, {group: "hud", text: unit.name, style: Object.create(this.TEXT_STYLE)});
	        unit_index += 1;
	        menu_items.push(unit_menu_item);
	    }, this);
	    // create units menu
	    units_menu = new Muryoma.Menu(this, group_name + "_menu", position, {group: "hud", menu_items: menu_items});      
	    */
	};
	
	Muryoma.ManageState.prototype.show_player_actions = function (position) {
	    /*
	    "use strict";
	    var actions, actions_menu_items, action_index, actions_menu;
	    // available actions
	    actions = [{text: "Attack", item_constructor: Muryoma.AttackMenuItem.prototype.constructor}];
	    actions_menu_items = [];
	    action_index = 0;
	    // create a menu item for each action
	    actions.forEach(function (action) {
	        actions_menu_items.push(new action.item_constructor(this, action.text + "_menu_item", {x: position.x, y: position.y + action_index * 20}, {group: "hud", text: action.text, style: Object.create(this.TEXT_STYLE)}));
	        action_index += 1;
	    }, this);
	    actions_menu = new Muryoma.Menu(this, "actions_menu", position, {group: "hud", menu_items: actions_menu_items});
	    */
	};
	
	Muryoma.ManageState.prototype.next_turn = function () {
	    /*
	    "use strict";
	    // takes the next unit
	    this.current_unit = this.units.shift();
	    // if the unit is alive, it acts, otherwise goes to the next turn
	    if (this.current_unit.alive) {
	        this.current_unit.act();
	        this.units.push(this.current_unit);
	    } else {
	        this.next_turn();
	    }
	    */
	};
	
	Muryoma.ManageState.prototype.render = function(){
	    /*
	    game.debug.cameraInfo(game.camera, 32, 32);                                   
	    */
	    for (var group in this.groups){                
	         game.debug.body(group);
	    } 
	}
	
	
	
	
	


/***/ },
/* 22 */
/***/ function(module, exports) {

	alert('Main');
	var Muryoma = Muryoma || {};
	var game = new Phaser.Game(1024, 768, Phaser.CANVAS);
	game.state.add("BootState", new Muryoma.BootState());
	game.state.add("LoadingState", new Muryoma.LoadingState());
	game.state.add("ManageState", new Muryoma.ManageState());
	game.state.start("BootState", true, false, "assets/levels/manage.json", "ManageState");

/***/ }
/******/ ]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAgOTBjZWU5ZWE5MGE5ZmQyM2EyOTMiLCJ3ZWJwYWNrOi8vLy4vc2NyaXB0cy5qcyIsIndlYnBhY2s6Ly8vLi9qcy9wcmVmYWJzL1ByZWZhYi5qcyIsIndlYnBhY2s6Ly8vLi9qcy9wcmVmYWJzL1RpbGVQcmVmYWIuanMiLCJ3ZWJwYWNrOi8vLy4vanMvcHJlZmFicy9UZXh0UHJlZmFiLmpzIiwid2VicGFjazovLy8uL2pzL1V0aWxzLmpzIiwid2VicGFjazovLy8uL2pzL3ByZWZhYnMvQmx1ZXByaW50cy9CbHVlcHJpbnQuanMiLCJ3ZWJwYWNrOi8vLy4vanMvcHJlZmFicy9CdWlsZGluZ3MvQnVpbGRpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vanMvcHJlZmFicy9IVUQvTWVudUl0ZW0uanMiLCJ3ZWJwYWNrOi8vLy4vanMvcHJlZmFicy9IVUQvTWVudS5qcyIsIndlYnBhY2s6Ly8vLi9qcy9wcmVmYWJzL0hVRC9FbmVteU1lbnVJdGVtLmpzIiwid2VicGFjazovLy8uL2pzL3ByZWZhYnMvSFVEL1BsYXllck1lbnVJdGVtLmpzIiwid2VicGFjazovLy8uL2pzL3ByZWZhYnMvSFVEL0F0dGFja01lbnVJdGVtLmpzIiwid2VicGFjazovLy8uL2pzL3ByZWZhYnMvSFVEL0J1aWxkQXJlYS5qcyIsIndlYnBhY2s6Ly8vLi9qcy9wcmVmYWJzL0hVRC9CbHVlcHJpbnRNZW51LmpzIiwid2VicGFjazovLy8uL2pzL3ByZWZhYnMvSFVEL0JsdWVwcmludE1lbnVJdGVtLmpzIiwid2VicGFjazovLy8uL2pzL3ByZWZhYnMvSFVEL1Nob3dTdGF0LmpzIiwid2VicGFjazovLy8uL2pzL3ByZWZhYnMvSFVEL0FjdGlvbk1lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vLy4vanMvcHJlZmFicy9IVUQvTWFya2VyLmpzIiwid2VicGFjazovLy8uL2pzL3ByZWZhYnMvSFVEL1N0YXRNYW5hZ2VyLmpzIiwid2VicGFjazovLy8uL2pzL3N0YXRlcy9Cb290U3RhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vanMvc3RhdGVzL0xvYWRpbmdTdGF0ZS5qcyIsIndlYnBhY2s6Ly8vLi9qcy9zdGF0ZXMvTWFuYWdlU3RhdGUuanMiLCJ3ZWJwYWNrOi8vLy4vanMvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0EsdUJBQWU7QUFDZjtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7Ozs7OztBQ3RDQTtBQUNBO0FBQ0E7QUFDQSx3Qjs7QUFFQTtBQUNBLGlEO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FBR0E7QUFDQTtBQUNBOztBQUVBLHlCOzs7Ozs7QUM5QkE7O0FBRUE7QUFDQTtBQUNBOztBQUVBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBLG9CO0FBQ0EsNkI7QUFDQTs7Ozs7Ozs7QUMxQkE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsK0Q7Ozs7OztBQ2xCQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTs7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EsK0Q7Ozs7OztBQ2pCQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsRzs7Ozs7O0FDZkE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSx1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FDbkNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVFO0FBQ0EsOEI7QUFDQSw0Qjs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOzs7Ozs7OztBQ2hDQTtBQUNBOztBQUVBO0FBQ0Esa0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSwyRDtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0M7QUFDQTs7Ozs7OztBQ3pDQTs7QUFFQTs7QUFFQTtBQUNBLGtCO0FBQ0E7QUFDQTs7QUFFQSwwQjtBQUNBLDZDO0FBQ0EsaUM7O0FBRUE7O0FBRUE7QUFDQTs7QUFFQSwwRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE07QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQSx5QkFBd0IscUNBQXFDO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLDhDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQSxnRjtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEc7Ozs7OztB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QTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxnRDtBQUNBO0FBQ0Esb0M7QUFDQTtBQUNBLE07QUFDQTs7Ozs7Ozs7Ozs7O0FDNVBBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdGIiwiZmlsZSI6Im11cnlvbWEubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pXG4gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG5cbiBcdFx0Ly8gQ3JlYXRlIGEgbmV3IG1vZHVsZSAoYW5kIHB1dCBpdCBpbnRvIHRoZSBjYWNoZSlcbiBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuIFx0XHRcdGV4cG9ydHM6IHt9LFxuIFx0XHRcdGlkOiBtb2R1bGVJZCxcbiBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4gXHRcdH07XG5cbiBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4gXHRcdG1vZHVsZXNbbW9kdWxlSWRdLmNhbGwobW9kdWxlLmV4cG9ydHMsIG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG4gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbiBcdFx0bW9kdWxlLmxvYWRlZCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gX193ZWJwYWNrX3B1YmxpY19wYXRoX19cbiBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiB3ZWJwYWNrL2Jvb3RzdHJhcCA5MGNlZTllYTkwYTlmZDIzYTI5M1xuICoqLyIsInJlcXVpcmUoJy4vanMvcHJlZmFicy9QcmVmYWIuanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9UaWxlUHJlZmFiLmpzJyk7XG5yZXF1aXJlKCcuL2pzL3ByZWZhYnMvVGV4dFByZWZhYi5qcycpO1xucmVxdWlyZSgnLi9qcy9VdGlscy5qcycpOyBcblxucmVxdWlyZSgnLi9qcy9wcmVmYWJzL0JsdWVwcmludHMvQmx1ZXByaW50LmpzJyk7XG4vL3JlcXVpcmUoJy4vanMvcHJlZmFicy9CbHVlcHJpbnRzL0hvdXNlQnAuanMnKTsgICAgICAgIFxuLy9yZXF1aXJlKCcuL2pzL3ByZWZhYnMvQmx1ZXByaW50cy9NaW5pbmdQb2ludC5qcycpO1xuXG5cbnJlcXVpcmUoJy4vanMvcHJlZmFicy9CdWlsZGluZ3MvQnVpbGRpbmcuanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvTWVudUl0ZW0uanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvTWVudS5qcycpO1xuXG5yZXF1aXJlKCcuL2pzL3ByZWZhYnMvSFVEL0VuZW15TWVudUl0ZW0uanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvUGxheWVyTWVudUl0ZW0uanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvQXR0YWNrTWVudUl0ZW0uanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvQnVpbGRBcmVhLmpzJyk7XG5yZXF1aXJlKCcuL2pzL3ByZWZhYnMvSFVEL0JsdWVwcmludE1lbnUuanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvQmx1ZXByaW50TWVudUl0ZW0uanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvU2hvd1N0YXQuanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvQWN0aW9uTWVzc2FnZS5qcycpO1xucmVxdWlyZSgnLi9qcy9wcmVmYWJzL0hVRC9NYXJrZXIuanMnKTtcbnJlcXVpcmUoJy4vanMvcHJlZmFicy9IVUQvU3RhdE1hbmFnZXIuanMnKTtcblxuICAgICBcbnJlcXVpcmUoJy4vanMvc3RhdGVzL0Jvb3RTdGF0ZS5qcycpO1xucmVxdWlyZSgnLi9qcy9zdGF0ZXMvTG9hZGluZ1N0YXRlLmpzJyk7XG5yZXF1aXJlKCcuL2pzL3N0YXRlcy9NYW5hZ2VTdGF0ZS5qcycpO1xuXG5yZXF1aXJlKCcuL2pzL21haW4uanMnKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vc2NyaXB0cy5qc1xuICoqIG1vZHVsZSBpZCA9IDBcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInZhciBNdXJ5b21hID0gTXVyeW9tYSB8fCB7fTtcblxuTXVyeW9tYS5QcmVmYWIgPSBmdW5jdGlvbiAoZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZV9zdGF0ZS5nYW1lLCBwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBwcm9wZXJ0aWVzLnRleHR1cmUpO1xuICAgIFxuICAgIHRoaXMuZ2FtZV9zdGF0ZSA9IGdhbWVfc3RhdGU7XG4gICAgXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICBcbiAgICB0aGlzLmdhbWVfc3RhdGUuZ3JvdXBzW3Byb3BlcnRpZXMuZ3JvdXBdLmFkZCh0aGlzKTtcbiAgICB0aGlzLmZyYW1lID0gK3Byb3BlcnRpZXMuZnJhbWU7XG4gICAgXG4gICAgaWYgKHByb3BlcnRpZXMuc2NhbGUpIHtcbiAgICAgICAgdGhpcy5zY2FsZS5zZXRUbyhwcm9wZXJ0aWVzLnNjYWxlLngsIHByb3BlcnRpZXMuc2NhbGUueSk7XG4gICAgfVxuICAgIFxuICAgIHRoaXMuZ2FtZV9zdGF0ZS5wcmVmYWJzW25hbWVdID0gdGhpcztcbn07XG5cbk11cnlvbWEuUHJlZmFiLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUpO1xuTXVyeW9tYS5QcmVmYWIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTXVyeW9tYS5QcmVmYWI7XG5cbk11cnlvbWEuUHJlZmFiLnByb3RvdHlwZS5yZW5kZXIgPSBmdW5jdGlvbigpe1xuICAgIC8vXCJ1c2Ugc3RyaWN0XCI7ICAgIFxuICAgIC8vZ2FtZS5kZWJ1Zy5ib2R5KHRoaXMpOyAgICBcbn07XG5cblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL1ByZWZhYi5qc1xuICoqIG1vZHVsZSBpZCA9IDFcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImNvbnNvbGUubG9nKCdUaWxlUHJlZmFiJyk7XG52YXIgTXVyeW9tYSA9IE11cnlvbWEgfHwge307XG5cbk11cnlvbWEuVGlsZVByZWZhYiA9IGZ1bmN0aW9uIChnYW1lX3N0YXRlLCBuYW1lLCBwb3NpdGlvbiwgcHJvcGVydGllcykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFBoYXNlci5UaWxlU3ByaXRlLmNhbGwodGhpcywgZ2FtZV9zdGF0ZS5nYW1lLCBwb3NpdGlvbi54LCBwb3NpdGlvbi55LCBwcm9wZXJ0aWVzLndpZHRoLCBwcm9wZXJ0aWVzLmhlaWdodCwgcHJvcGVydGllcy50ZXh0dXJlKTtcbiAgICBcbiAgICB0aGlzLmdhbWVfc3RhdGUgPSBnYW1lX3N0YXRlO1xuICAgIFxuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgXG4gICAgdGhpcy5nYW1lX3N0YXRlLmdyb3Vwc1twcm9wZXJ0aWVzLmdyb3VwXS5hZGQodGhpcyk7XG4gICAgdGhpcy5mcmFtZSA9ICtwcm9wZXJ0aWVzLmZyYW1lO1xuICAgIFxuICAgIHRoaXMuZ2FtZV9zdGF0ZS5wcmVmYWJzW25hbWVdID0gdGhpcztcbn07XG5cbk11cnlvbWEuVGlsZVByZWZhYi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5UaWxlU3ByaXRlLnByb3RvdHlwZSk7XG5NdXJ5b21hLlRpbGVQcmVmYWIucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTXVyeW9tYS5UaWxlUHJlZmFiO1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL1RpbGVQcmVmYWIuanNcbiAqKiBtb2R1bGUgaWQgPSAyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJjb25zb2xlLmxvZygnVGV4dFByZWZhYicpO1xudmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xuXG5NdXJ5b21hLlRleHRQcmVmYWIgPSBmdW5jdGlvbiAoZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBQaGFzZXIuVGV4dC5jYWxsKHRoaXMsIGdhbWVfc3RhdGUuZ2FtZSwgcG9zaXRpb24ueCwgcG9zaXRpb24ueSwgcHJvcGVydGllcy50ZXh0LCBwcm9wZXJ0aWVzLnN0eWxlKTtcbiAgICBcbiAgICB0aGlzLmdhbWVfc3RhdGUgPSBnYW1lX3N0YXRlO1xuICAgIFxuICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgXG4gICAgdGhpcy5nYW1lX3N0YXRlLmdyb3Vwc1twcm9wZXJ0aWVzLmdyb3VwXS5hZGQodGhpcyk7XG4gICAgXG4gICAgdGhpcy5nYW1lX3N0YXRlLnByZWZhYnNbbmFtZV0gPSB0aGlzO1xufTtcblxuTXVyeW9tYS5UZXh0UHJlZmFiLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlRleHQucHJvdG90eXBlKTtcbk11cnlvbWEuVGV4dFByZWZhYi5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBNdXJ5b21hLlRleHRQcmVmYWI7XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL2pzL3ByZWZhYnMvVGV4dFByZWZhYi5qc1xuICoqIG1vZHVsZSBpZCA9IDNcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImNvbnNvbGUubG9nKCdVdGlscycpO1xudmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xuXG5NdXJ5b21hLmNyZWF0ZV9wcmVmYWJfZnJvbV9wb29sID0gZnVuY3Rpb24gKHBvb2wsIHByZWZhYl9jb25zdHJ1Y3RvciwgZ2FtZV9zdGF0ZSwgcHJlZmFiX25hbWUsIHByZWZhYl9wb3NpdGlvbiwgcHJlZmFiX3Byb3BlcnRpZXMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB2YXIgcHJlZmFiO1xuICAgIC8vIGdldCB0aGUgZmlyc3QgZGVhZCBwcmVmYWIgZnJvbSB0aGUgcG9vbFxuICAgIHByZWZhYiA9IHBvb2wuZ2V0Rmlyc3REZWFkKCk7XG4gICAgaWYgKCFwcmVmYWIpIHtcbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgbm8gZGVhZCBwcmVmYWIsIGNyZWF0ZSBhIG5ldyBvbmVcbiAgICAgICAgcHJlZmFiID0gbmV3IHByZWZhYl9jb25zdHJ1Y3RvcihnYW1lX3N0YXRlLCBwcmVmYWJfbmFtZSwgcHJlZmFiX3Bvc2l0aW9uLCBwcmVmYWJfcHJvcGVydGllcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gaWYgdGhlcmUgaXMgYSBkZWFkIHByZWZhYiwgcmVzZXQgaXQgaW4gdGhlIG5ldyBwb3NpdGlvblxuICAgICAgICBwcmVmYWIucmVzZXQocHJlZmFiX3Bvc2l0aW9uLngsIHByZWZhYl9wb3NpdGlvbi55KTtcbiAgICB9XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9VdGlscy5qc1xuICoqIG1vZHVsZSBpZCA9IDRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImNvbnNvbGUubG9nKCdCbHVlcHJpbnQnKTtcbnZhciBNdXJ5b21hID0gTXVyeW9tYSB8fCB7fTtcbmNvbnNvbGUubG9nKFwiTXVyeW9tYSBcIiwgTXVyeW9tYSk7XG5cbk11cnlvbWEuQmx1ZXByaW50ID0gZnVuY3Rpb24gKGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgTXVyeW9tYS5QcmVmYWIuY2FsbCh0aGlzLCBnYW1lX3N0YXRlLCBuYW1lLCBwb3NpdGlvbiwgcHJvcGVydGllcyk7ICAgIFxuICAgIHRoaXMuc3RhdHMgPSBwcm9wZXJ0aWVzLnN0YXRzO1xuICAgIHRoaXMuaW5wdXRFbmFibGVkID0gdHJ1ZTtcbiAgICB0aGlzLmV2ZW50cy5vbklucHV0T3Zlci5hZGQodGhpcy5pbnB1dE92ZXIsIHRoaXMpO1xuICAgIHRoaXMuZXZlbnRzLm9uSW5wdXRPdXQuYWRkKHRoaXMuaW5wdXRPdXQsIHRoaXMpO1xuICAgIHRoaXMuZXZlbnRzLm9uSW5wdXREb3duLmFkZCh0aGlzLm9uSW5wdXREb3duLCB0aGlzKTtcbn07XG5cbk11cnlvbWEuQmx1ZXByaW50LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTXVyeW9tYS5QcmVmYWIucHJvdG90eXBlKTtcbk11cnlvbWEuQmx1ZXByaW50LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuQmx1ZXByaW50O1xuXG5NdXJ5b21hLkJsdWVwcmludC5wcm90b3R5cGUucmVzdG9yZV90aW50ID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHRoaXMudGludCA9IDB4RkZGRkZGO1xufTtcblxuTXVyeW9tYS5CbHVlcHJpbnQucHJvdG90eXBlLmlucHV0T3ZlciA9IGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGNvbnNvbGUubG9nKCdCUCBpbnB1dE92ZXInKTtcbn07XG5cbk11cnlvbWEuQmx1ZXByaW50LnByb3RvdHlwZS5pbnB1dE91dCA9IGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGNvbnNvbGUubG9nKCdCUCBpbnB1dE91dCcpO1xufTtcblxuTXVyeW9tYS5CbHVlcHJpbnQucHJvdG90eXBlLm9uSW5wdXREb3duID0gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgY29uc29sZS5sb2coJ29uSW5wdXREb3duJyk7XG59O1xuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL2pzL3ByZWZhYnMvQmx1ZXByaW50cy9CbHVlcHJpbnQuanNcbiAqKiBtb2R1bGUgaWQgPSA1XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJjb25zb2xlLmxvZygnQnVpbGRpbmcnKTtcbnZhciBNdXJ5b21hID0gTXVyeW9tYSB8fCB7fTtcblxuTXVyeW9tYS5CdWlsZGluZyA9IGZ1bmN0aW9uIChnYW1lX3N0YXRlLCBuYW1lLCBwb3NpdGlvbiwgcHJvcGVydGllcykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE11cnlvbWEuUHJlZmFiLmNhbGwodGhpcywgZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpOyAgIFxuICAgIHRoaXMuaW5wdXRFbmFibGVkID0gdHJ1ZTsgIFxuICAgIHRoaXMuZW5hYmxlQm9keSA9IHRydWU7ICAgICAgXG4gICAgXG4gICAgLy90aGlzLmV2ZW50cy5vbklucHV0T3Zlci5hZGQodGhpcy5pbnB1dE92ZXIsIHRoaXMpO1xuICAgIC8vdGhpcy5ldmVudHMub25JbnB1dE91dC5hZGQodGhpcy5pbnB1dE91dCwgdGhpcyk7XG4gICAgLy90aGlzLmV2ZW50cy5vbklucHV0RG93bi5hZGQodGhpcy5vbklucHV0RG93biwgdGhpcyk7XG59O1xuXG5NdXJ5b21hLkJ1aWxkaW5nLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTXVyeW9tYS5QcmVmYWIucHJvdG90eXBlKTtcbk11cnlvbWEuQnVpbGRpbmcucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTXVyeW9tYS5CdWlsZGluZztcblxuTXVyeW9tYS5CdWlsZGluZy5wcm90b3R5cGUuaW5wdXRPdmVyID0gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgY29uc29sZS5sb2coJ0J1aWxkaW5nIGlucHV0T3ZlcicpO1xufTtcblxuTXVyeW9tYS5CdWlsZGluZy5wcm90b3R5cGUuaW5wdXRPdXQgPSBmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBjb25zb2xlLmxvZygnQnVpbGRpbmcgaW5wdXRPdXQnKTtcbn07XG5cbk11cnlvbWEuQnVpbGRpbmcucHJvdG90eXBlLm9uSW5wdXREb3duID0gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgY29uc29sZS5sb2coJ0J1aWxkaW5nIG9uSW5wdXREb3duJyk7XG59O1xuXG5jb25zb2xlLmxvZygnQnVpbGRpbmcyJyk7XG5cblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0J1aWxkaW5ncy9CdWlsZGluZy5qc1xuICoqIG1vZHVsZSBpZCA9IDZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImNvbnNvbGUubG9nKCdNZW51SXRlbScpO1xudmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xuXG5NdXJ5b21hLk1lbnVJdGVtID0gZnVuY3Rpb24gKGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7ICAgIFxuICAgIE11cnlvbWEuVGV4dFByZWZhYi5jYWxsKHRoaXMsIGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKTtcbiAgICBcbiAgICB0aGlzLmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgLy90aGlzLmV2ZW50cy5vbklucHV0T3Zlci5hZGQodGhpcy5pbnB1dE92ZXIsIHRoaXMpO1xuICAgIC8vdGhpcy5ldmVudHMub25JbnB1dE91dC5hZGQodGhpcy5pbnB1dE91dCwgdGhpcyk7XG4gICAgLy90aGlzLmV2ZW50cy5vbklucHV0RG93bi5hZGQodGhpcy5vbklucHV0RG93biwgdGhpcyk7ICAgIFxufTtcblxuTXVyeW9tYS5NZW51SXRlbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKE11cnlvbWEuVGV4dFByZWZhYi5wcm90b3R5cGUpO1xuTXVyeW9tYS5NZW51SXRlbS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBNdXJ5b21hLk1lbnVJdGVtO1xuXG5NdXJ5b21hLk1lbnVJdGVtLnByb3RvdHlwZS5zZWxlY3Rpb25fb3ZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB0aGlzLmZpbGwgPSBcIiNGRkZGMDBcIjtcbn07XG5cbk11cnlvbWEuTWVudUl0ZW0ucHJvdG90eXBlLnNlbGVjdGlvbl9vdXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdGhpcy5maWxsID0gXCIjRkZGRkZGXCI7XG59O1xuLypcbk11cnlvbWEuTWVudUl0ZW0ucHJvdG90eXBlLmlucHV0T3ZlciA9IGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGNvbnNvbGUubG9nKCdpbnB1dE92ZXInKTtcbn07XG5cbk11cnlvbWEuTWVudUl0ZW0ucHJvdG90eXBlLmlucHV0T3V0ID0gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgY29uc29sZS5sb2coJ2lucHV0T3V0Jyk7XG4gIFxufTtcbiovXG5NdXJ5b21hLk1lbnVJdGVtLnByb3RvdHlwZS5vbklucHV0RG93biA9IGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIC8vY29uc29sZS5sb2coJ29uSW5wdXREb3duJyk7XG4gICAgLy9jb25zb2xlLmxvZygnZ2FtZV9zdGF0ZSAnLCB0aGlzLnBhcmVudCk7ICAgIFxufTtcblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9NZW51SXRlbS5qc1xuICoqIG1vZHVsZSBpZCA9IDdcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsImNvbnNvbGUubG9nKCdNZW51Jyk7XG5cbnZhciBNdXJ5b21hID0gTXVyeW9tYSB8fCB7fTtcblxuTXVyeW9tYS5NZW51ID0gZnVuY3Rpb24gKGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7ICAgIFxuICAgIHZhciBsaXZlX2luZGV4LCBsaWZlO1xuICAgIE11cnlvbWEuUHJlZmFiLmNhbGwodGhpcywgZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpO1xuICAgIFxuICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOyAgICBcbiAgICB0aGlzLm1lbnVfaXRlbXMgPSBwcm9wZXJ0aWVzLm1lbnVfaXRlbXM7ICAgIFxuICAgIHRoaXMuY3VycmVudF9pdGVtX2luZGV4ID0gMDsgXG4gICAgXG59O1xuXG5NdXJ5b21hLk1lbnUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNdXJ5b21hLlByZWZhYi5wcm90b3R5cGUpO1xuTXVyeW9tYS5NZW51LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuTWVudTtcblxuTXVyeW9tYS5NZW51LnByb3RvdHlwZS5wcm9jZXNzX2lucHV0ID0gZnVuY3Rpb24gKGV2ZW50KSB7ICAgIFxuICAgIC8vY29uc29sZS5sb2coJ21lbnUgcHJvY2Vzc19pbnB1dCAnLCBldmVudC5rZXlDb2RlKTtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpIHtcbiAgICBjYXNlIFBoYXNlci5LZXlib2FyZC5VUDpcbiAgICAgICAgaWYgKHRoaXMuY3VycmVudF9pdGVtX2luZGV4ID4gMCkge1xuICAgICAgICAgICAgLy8gbmF2aWdhdGUgdG8gcHJldmlvdXMgaXRlbVxuICAgICAgICAgICAgdGhpcy5tb3ZlX3NlbGVjdGlvbih0aGlzLmN1cnJlbnRfaXRlbV9pbmRleCAtIDEpO1xuICAgICAgICB9XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgUGhhc2VyLktleWJvYXJkLkRPV046XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRfaXRlbV9pbmRleCA8IHRoaXMubWVudV9pdGVtcy5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgICAvLyBuYXZpZ2F0ZSB0byBuZXh0IGl0ZW1cbiAgICAgICAgICAgIHRoaXMubW92ZV9zZWxlY3Rpb24odGhpcy5jdXJyZW50X2l0ZW1faW5kZXggKyAxKTtcbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICBjYXNlIFBoYXNlci5LZXlib2FyZC5TUEFDRUJBUjpcbiAgICAgICAgdGhpcy5tZW51X2l0ZW1zW3RoaXMuY3VycmVudF9pdGVtX2luZGV4XS5zZWxlY3QoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgfSAgIFxufTtcblxuTXVyeW9tYS5NZW51LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoaXRlbV9pbmRleCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xufTtcblxuXG5NdXJ5b21hLk1lbnUucHJvdG90eXBlLm1vdmVfc2VsZWN0aW9uID0gZnVuY3Rpb24gKGl0ZW1faW5kZXgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB0aGlzLm1lbnVfaXRlbXNbdGhpcy5jdXJyZW50X2l0ZW1faW5kZXhdLnNlbGVjdGlvbl9vdXQoKTtcbiAgICB0aGlzLmN1cnJlbnRfaXRlbV9pbmRleCA9IGl0ZW1faW5kZXg7XG4gICAgdGhpcy5tZW51X2l0ZW1zW3RoaXMuY3VycmVudF9pdGVtX2luZGV4XS5zZWxlY3Rpb25fb3ZlcigpO1xufTtcblxuTXVyeW9tYS5NZW51LnByb3RvdHlwZS5maW5kX2l0ZW1faW5kZXggPSBmdW5jdGlvbiAodGV4dCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHZhciBpdGVtX2luZGV4O1xuICAgIGZvciAoaXRlbV9pbmRleCA9IDA7IGl0ZW1faW5kZXggPCB0aGlzLm1lbnVfaXRlbXMubGVuZ3RoOyBpdGVtX2luZGV4ICs9IDEpIHtcbiAgICAgICAgaWYgKHRoaXMubWVudV9pdGVtc1tpdGVtX2luZGV4XS50ZXh0ID09PSB0ZXh0KSB7XG4gICAgICAgICAgICByZXR1cm4gaXRlbV9pbmRleDtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbk11cnlvbWEuTWVudS5wcm90b3R5cGUucmVtb3ZlX2l0ZW0gPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB2YXIgbWVudV9pdGVtO1xuICAgIG1lbnVfaXRlbSA9IHRoaXMubWVudV9pdGVtc1tpbmRleF07XG4gICAgLy8gcmVtb3ZlIG1lbnUgaXRlbVxuICAgIHRoaXMubWVudV9pdGVtcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgIC8vIHVwZGF0ZSBjdXJyZW50X2l0ZW1faW5kZXggaWYgbmVjZXNzYXJ5XG4gICAgaWYgKHRoaXMuY3VycmVudF9pdGVtX2luZGV4ID09PSBpbmRleCkge1xuICAgICAgICB0aGlzLmN1cnJlbnRfaXRlbV9pbmRleCA9IDA7XG4gICAgfVxuICAgIHJldHVybiBtZW51X2l0ZW07XG59O1xuXG5NdXJ5b21hLk1lbnUucHJvdG90eXBlLmVuYWJsZSA9IGZ1bmN0aW9uICgpIHsgICAgXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdGhpcy5jdXJyZW50X2l0ZW1faW5kZXggPSAwO1xuICAgIGlmICh0aGlzLm1lbnVfaXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICB0aGlzLm1lbnVfaXRlbXNbdGhpcy5jdXJyZW50X2l0ZW1faW5kZXhdLnNlbGVjdGlvbl9vdmVyKCk7XG4gICAgfVxuICAgIFxuICAgIHRoaXMuZ2FtZV9zdGF0ZS5nYW1lLmlucHV0LmtleWJvYXJkLmFkZENhbGxiYWNrcyh0aGlzLCB0aGlzLnByb2Nlc3NfaW5wdXQpOyAgICBcbn07XG5cbk11cnlvbWEuTWVudS5wcm90b3R5cGUuZGlzYWJsZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAvKlxuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIGlmICh0aGlzLm1lbnVfaXRlbXMubGVuZ3RoID4gMCkge1xuICAgICAgICB0aGlzLm1lbnVfaXRlbXNbdGhpcy5jdXJyZW50X2l0ZW1faW5kZXhdLnNlbGVjdGlvbl9vdXQoKTtcbiAgICB9XG4gICAgdGhpcy5jdXJyZW50X2l0ZW1faW5kZXggPSAwO1xuICAgICovXG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9NZW51LmpzXG4gKiogbW9kdWxlIGlkID0gOFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwidmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xuXG5NdXJ5b21hLkVuZW15TWVudUl0ZW0gPSBmdW5jdGlvbiAoZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBNdXJ5b21hLk1lbnVJdGVtLmNhbGwodGhpcywgZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpO1xufTtcblxuTXVyeW9tYS5FbmVteU1lbnVJdGVtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTXVyeW9tYS5NZW51SXRlbS5wcm90b3R5cGUpO1xuTXVyeW9tYS5FbmVteU1lbnVJdGVtLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuRW5lbXlNZW51SXRlbTtcblxuTXVyeW9tYS5FbmVteU1lbnVJdGVtLnByb3RvdHlwZS5zZWxlY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIGVuZW15O1xuICAgIC8vIGdldCBlbmVteSBwcmVmYWJcbiAgICBlbmVteSA9IHRoaXMuZ2FtZV9zdGF0ZS5wcmVmYWJzW3RoaXMudGV4dF07XG4gICAgLy8gYXR0YWNrIHNlbGVjdGVkIGVuZW15XG4gICAgdGhpcy5nYW1lX3N0YXRlLmN1cnJlbnRfdW5pdC5hdHRhY2soZW5lbXkpO1xuICAgIC8vIGRpc2FibGUgbWVudXNcbiAgICB0aGlzLmdhbWVfc3RhdGUucHJlZmFicy5lbmVteV91bml0c19tZW51LmRpc2FibGUoKTtcbiAgICB0aGlzLmdhbWVfc3RhdGUucHJlZmFicy5wbGF5ZXJfdW5pdHNfbWVudS5kaXNhYmxlKCk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9FbmVteU1lbnVJdGVtLmpzXG4gKiogbW9kdWxlIGlkID0gOVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwidmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xuXG5NdXJ5b21hLlBsYXllck1lbnVJdGVtID0gZnVuY3Rpb24gKGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgTXVyeW9tYS5NZW51SXRlbS5jYWxsKHRoaXMsIGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKTtcbiAgICBcbiAgICB0aGlzLnBsYXllcl91bml0X2hlYWx0aCA9IG5ldyBNdXJ5b21hLlNob3dTdGF0KHRoaXMuZ2FtZV9zdGF0ZSwgdGhpcy50ZXh0ICsgXCJfaGVhbHRoXCIsIHt4OiAyODAsIHk6IHRoaXMueX0sIHtncm91cDogXCJodWRcIiwgdGV4dDogXCJcIiwgc3R5bGU6IHByb3BlcnRpZXMuc3R5bGUsIHByZWZhYjogdGhpcy50ZXh0LCBzdGF0OiBcImhlYWx0aFwifSk7XG59O1xuXG5NdXJ5b21hLlBsYXllck1lbnVJdGVtLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTXVyeW9tYS5NZW51SXRlbS5wcm90b3R5cGUpO1xuTXVyeW9tYS5QbGF5ZXJNZW51SXRlbS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBNdXJ5b21hLlBsYXllck1lbnVJdGVtO1xuXG5NdXJ5b21hLlBsYXllck1lbnVJdGVtLnByb3RvdHlwZS5zZWxlY3QgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9QbGF5ZXJNZW51SXRlbS5qc1xuICoqIG1vZHVsZSBpZCA9IDEwXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJ2YXIgTXVyeW9tYSA9IE11cnlvbWEgfHwge307XG5cbk11cnlvbWEuQXR0YWNrTWVudUl0ZW0gPSBmdW5jdGlvbiAoZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBNdXJ5b21hLk1lbnVJdGVtLmNhbGwodGhpcywgZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpO1xufTtcblxuTXVyeW9tYS5BdHRhY2tNZW51SXRlbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKE11cnlvbWEuTWVudUl0ZW0ucHJvdG90eXBlKTtcbk11cnlvbWEuQXR0YWNrTWVudUl0ZW0ucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTXVyeW9tYS5BdHRhY2tNZW51SXRlbTtcblxuTXVyeW9tYS5BdHRhY2tNZW51SXRlbS5wcm90b3R5cGUuc2VsZWN0ID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIC8vIGRpc2FibGUgYWN0aW9ucyBtZW51XG4gICAgdGhpcy5nYW1lX3N0YXRlLnByZWZhYnMuYWN0aW9uc19tZW51LmRpc2FibGUoKTtcbiAgICAvLyBlbmFibGUgZW5lbXkgdW5pdHMgbWVudSBzbyB0aGUgcGxheWVyIGNhbiBjaG9vc2UgdGhlIHRhcmdldFxuICAgIHRoaXMuZ2FtZV9zdGF0ZS5wcmVmYWJzLmVuZW15X3VuaXRzX21lbnUuZW5hYmxlKCk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9BdHRhY2tNZW51SXRlbS5qc1xuICoqIG1vZHVsZSBpZCA9IDExXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJ2YXIgTXVyeW9tYSA9IE11cnlvbWEgfHwge307XG5cbk11cnlvbWEuQnVpbGRBcmVhID0gZnVuY3Rpb24gKGdhbWVfc3RhdGUsIGxheWVyKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG5cbiAgICB2YXIgbmFtZSA9ICdidWlsZF9hcmVhJzsgICAgXG4gICAgdmFyIHBvc2l0aW9uID0ge3g6IDAsIHk6IDB9O1xuICAgIHZhciBoZWlnaHQgPSA1ODQ7XG4gICAgdmFyIHdpZHRoID0gMTAyNDtcblxuICAgIC8vIGNyZWF0ZSBhIG5ldyBiaXRtYXAgZGF0YSBvYmplY3RcbiAgICB2YXIgYm1kID0gZ2FtZS5hZGQuYml0bWFwRGF0YSh3aWR0aCxoZWlnaHQpOyAgIFxuICAgIFxuICAgIHRoaXMubWFya2VyID0gbmV3IE11cnlvbWEuTWFya2VyKGdhbWVfc3RhdGUsIGxheWVyKTtcblxuICAgIC8vIGRyYXcgdG8gdGhlIGNhbnZhcyBjb250ZXh0IGxpa2Ugbm9ybWFsXG4gICAgYm1kLmN0eC5iZWdpblBhdGgoKTtcbiAgICBibWQuY3R4LnJlY3QoMCwwLHdpZHRoLGhlaWdodCk7XG4gICAgLy9kZWJ1Z1xuICAgIC8vYm1kLmN0eC5maWxsU3R5bGUgPSAnIzBCNDg2Qic7ICAgICAgICBcbiAgICAvL2JtZC5jdHguZmlsbCgpO1xuXG4gICAgdmFyIHByb3BlcnRpZXMgPSB7Z3JvdXA6ICdodWQnLCB3aWR0aDogd2lkdGgsIGhlaWdodDogaGVpZ2h0LCB0ZXh0dXJlOiBibWR9O1xuXG4gICAgTXVyeW9tYS5QcmVmYWIuY2FsbCh0aGlzLCBnYW1lX3N0YXRlLCBuYW1lLCBwb3NpdGlvbiwgcHJvcGVydGllcyk7ICAgIFxuXG4gICAgdGhpcy5pbnB1dEVuYWJsZWQgPSB0cnVlO1xuICAgIHRoaXMuaW5wdXQuZW5hYmxlU25hcCgzMiwgMzIsIGZhbHNlLCB0cnVlKTtcbiAgICB0aGlzLmV2ZW50cy5vbklucHV0T3Zlci5hZGQodGhpcy5pbnB1dE92ZXIsIHRoaXMpO1xuICAgIHRoaXMuZXZlbnRzLm9uSW5wdXRPdXQuYWRkKHRoaXMuaW5wdXRPdXQsIHRoaXMpO1xuICAgIHRoaXMuZXZlbnRzLm9uSW5wdXREb3duLmFkZCh0aGlzLm9uSW5wdXREb3duLCB0aGlzKTsgIFxufTtcblxuTXVyeW9tYS5CdWlsZEFyZWEucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNdXJ5b21hLlByZWZhYi5wcm90b3R5cGUpO1xuTXVyeW9tYS5CdWlsZEFyZWEucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTXVyeW9tYS5CdWlsZEFyZWE7XG5cbk11cnlvbWEuQnVpbGRBcmVhLnByb3RvdHlwZS5yZXN0b3JlX3RpbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdGhpcy50aW50ID0gMHhGRkZGRkY7XG59O1xuXG5NdXJ5b21hLkJ1aWxkQXJlYS5wcm90b3R5cGUuaW5wdXRPdmVyID0gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgLypcbiAgICBjb25zb2xlLmxvZygnQnVpbGRBcmVhIGlucHV0T3ZlcicpOyAgICBcbiAgICBjb25zb2xlLmxvZygndGhpcy5tYXJrZXIgJywgdGhpcy5tYXJrZXIpO1xuICAgIGNvbnNvbGUubG9nKCdodWQgZ3JvdXAgJywgdGhpcy5nYW1lX3N0YXRlLmdyb3Vwcy5odWQuY2hpbGRyZW4pO1xuICAgICovXG4gICAgdGhpcy5tYXJrZXIudmlzaWJsZSA9IHRydWU7ICAgICAgXG59O1xuXG5NdXJ5b21hLkJ1aWxkQXJlYS5wcm90b3R5cGUuaW5wdXRPdXQgPSBmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBjb25zb2xlLmxvZygnQnVpbGRBcmVhIGlucHV0T3V0Jyk7ICAgIFxuICAgIHRoaXMubWFya2VyLnZpc2libGUgPSBmYWxzZTsgIFxufTtcblxuTXVyeW9tYS5CdWlsZEFyZWEucHJvdG90eXBlLm9uSW5wdXREb3duID0gZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7ICAgIFxuICAgIHZhciBjaGlsZEFycmF5ID0gdGhpcy5nYW1lX3N0YXRlLmdyb3Vwcy5odWQuY2hpbGRyZW47ICAgIFxuICAgIHZhciBodWRfbWVudSA9IGNoaWxkQXJyYXkuZmlsdGVyKGZ1bmN0aW9uKGEpeyByZXR1cm4gYS5uYW1lID09ICdodWRfbWVudScgfSlbMF07ICAgICAgICBcbiAgICB2YXIgbWFya2VyID0gY2hpbGRBcnJheS5maWx0ZXIoZnVuY3Rpb24oYSl7IHJldHVybiBhLm5hbWUgPT0gJ21hcmtlcicgfSlbMF07XG5cbiAgICBnYW1lLnBoeXNpY3MuYXJjYWRlLmVuYWJsZShbbWFya2VyLCB0aGlzLmdhbWVfc3RhdGUuZ3JvdXBzLmJ1aWxkaW5nc10pOyAgICBcbiAgICB2YXIgY0J1aWxkaW5ncyA9IGdhbWUucGh5c2ljcy5hcmNhZGUuY29sbGlkZShtYXJrZXIsIHRoaXMuZ2FtZV9zdGF0ZS5ncm91cHMuYnVpbGRpbmdzLCBmdW5jdGlvbihzcHJpdGUxLCBzcHJpdGUyKXsgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSk7ICBcblxuICAgIHZhciBjYnAgPSBodWRfbWVudS5jdXJyZW50X2JsdWVwcmludDsgXG4gICAgY29uc29sZS5sb2coJ2N1cnJlbnRfYmx1ZXByaW50ICcsIGh1ZF9tZW51LmN1cnJlbnRfYmx1ZXByaW50KTtcbiAgICBpZihjYnAgJiYgIWNCdWlsZGluZ3Mpe1xuICAgICAgICB2YXIgeCA9IGxheWVyLmdldFRpbGVYKGdhbWUuaW5wdXQuYWN0aXZlUG9pbnRlci53b3JsZFgpICogMzI7XG4gICAgICAgIHZhciB5ID0gbGF5ZXIuZ2V0VGlsZVkoZ2FtZS5pbnB1dC5hY3RpdmVQb2ludGVyLndvcmxkWSkgKiAzMjsgXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0ge2dyb3VwOididWlsZGluZ3MnLCB0ZXh0dXJlOiBjYnAudGV4dHVyZX07ICAgXG4gICAgICAgIG5ldyBNdXJ5b21hLkJ1aWxkaW5nKHRoaXMuZ2FtZV9zdGF0ZSwgY2JwLmtleSwge3g6eCwgeTp5fSwgcHJvcGVydGllcyk7ICAgICAgICAgXG4gICAgICAgIC8vaHVkX21lbnUuY3VycmVudF9ibHVlcHJpbnQgPSBudWxsO1xuICAgICAgICAvL21hcmtlci5raWxsKCk7ICAgICAgICBcbiAgICB9ICAgXG4gICAgXG59O1xuXG5cblxuXG5cblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9CdWlsZEFyZWEuanNcbiAqKiBtb2R1bGUgaWQgPSAxMlxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwidmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xuXG5NdXJ5b21hLkJsdWVwcmludE1lbnUgPSBmdW5jdGlvbiAoZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAvKlxuICAgIGNvbnNvbGUubG9nKCctLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTtcbiAgICBjb25zb2xlLmxvZygnZ2FtZV9zdGF0ZSAnLCBnYW1lX3N0YXRlKTtcbiAgICBjb25zb2xlLmxvZygnbmFtZSAnLCBuYW1lKTtcbiAgICBjb25zb2xlLmxvZygncG9zaXRpb24gJywgcG9zaXRpb24pO1xuICAgICovXG4gICAgXG4gICAgdmFyIGxpdmVfaW5kZXgsIGxpZmU7XG4gICAgTXVyeW9tYS5QcmVmYWIuY2FsbCh0aGlzLCBnYW1lX3N0YXRlLCBuYW1lLCBwb3NpdGlvbiwgcHJvcGVydGllcyk7ICAgIFxuICAgIHRoaXMuYmx1ZXByaW50TWVudV9pdGVtcyA9IHByb3BlcnRpZXMubWVudV9pdGVtczsgICAgXG4gICAgdGhpcy5jdXJyZW50X2JsdWVwcmludCA9IG51bGw7ICAgXG4gICAgdGhpcy5jb2xvckRpc2FibGVkKCk7ICAgXG59O1xuXG5NdXJ5b21hLkJsdWVwcmludE1lbnUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNdXJ5b21hLlByZWZhYi5wcm90b3R5cGUpO1xuTXVyeW9tYS5CbHVlcHJpbnRNZW51LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuQmx1ZXByaW50TWVudTtcblxuTXVyeW9tYS5CbHVlcHJpbnRNZW51LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoaXRlbV9pbmRleCkge1xuICAgIFwidXNlIHN0cmljdFwiOyAgICBcbn07XG5cbk11cnlvbWEuQmx1ZXByaW50TWVudS5wcm90b3R5cGUuc2V0Q3VycmVudEJsdWVwcmludCA9IGZ1bmN0aW9uIChibHVlcHJpbnQpIHtcbiAgICBcInVzZSBzdHJpY3RcIjsgICAgXG4gICAgY29uc29sZS5sb2coJ3NldEN1cnJlbnRCbHVlcHJpbnQgJywgYmx1ZXByaW50KTtcbiAgICBcbiAgICB0aGlzLmN1cnJlbnRfYmx1ZXByaW50ID0gYmx1ZXByaW50O1xuICAgIHZhciBjaGlsZEFycmF5ID0gdGhpcy5nYW1lX3N0YXRlLmdyb3Vwcy5odWQuY2hpbGRyZW47ICAgIFxuICAgIHZhciBtYXJrZXIgPSBjaGlsZEFycmF5LmZpbHRlcihmdW5jdGlvbihhKXsgcmV0dXJuIGEubmFtZSA9PSAnbWFya2VyJyB9KVswXTtcbiAgICBtYXJrZXIuc2V0RGltZW5zaW9ucyhibHVlcHJpbnQpO1xuICAgIHRoaXMuY29sb3JEaXNhYmxlZCgpO1xuICAgIGJsdWVwcmludC50aW50ID0gMHhGRkZGRkY7XG59O1xuXG5NdXJ5b21hLkJsdWVwcmludE1lbnUucHJvdG90eXBlLmNvbG9yRGlzYWJsZWQgPSBmdW5jdGlvbigpe1xuICAgIFwidXNlIHN0cmljdFwiOyAgICBcbiAgICBmb3IgKHZhciBpID0gdGhpcy5ibHVlcHJpbnRNZW51X2l0ZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIHRoaXMuYmx1ZXByaW50TWVudV9pdGVtc1tpXS50aW50ID0gMHg3NTc1NztcbiAgICB9O1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vanMvcHJlZmFicy9IVUQvQmx1ZXByaW50TWVudS5qc1xuICoqIG1vZHVsZSBpZCA9IDEzXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJ2YXIgTXVyeW9tYSA9IE11cnlvbWEgfHwge307XG5cbk11cnlvbWEuQmx1ZXByaW50TWVudUl0ZW0gPSBmdW5jdGlvbiAoZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAvKlxuICAgIGNvbnNvbGUubG9nKCdCbHVlcHJpbnRNZW51SXRlbSAtLS0tLS0tLS0tLS0tLS0tLS0tLS0nKTsgICAgXG4gICAgY29uc29sZS5sb2coJ25hbWUgJywgbmFtZSk7XG4gICAgY29uc29sZS5sb2coJ3Bvc2l0aW9uICcsIHBvc2l0aW9uKTtcbiAgICBjb25zb2xlLmxvZygncHJvcGVydGllcyAnLCBwcm9wZXJ0aWVzKTtcbiAgICAqL1xuXG4gICAgTXVyeW9tYS5QcmVmYWIuY2FsbCh0aGlzLCBnYW1lX3N0YXRlLCBuYW1lLCBwb3NpdGlvbiwgcHJvcGVydGllcyk7XG5cbiAgICB0aGlzLmlucHV0RW5hYmxlZCA9IHRydWU7XG4gICAgLy90aGlzLmV2ZW50cy5vbklucHV0T3Zlci5hZGQodGhpcy5pbnB1dE92ZXIsIHRoaXMpO1xuICAgIC8vdGhpcy5ldmVudHMub25JbnB1dE91dC5hZGQodGhpcy5pbnB1dE91dCwgdGhpcyk7XG4gICAgdGhpcy5ldmVudHMub25JbnB1dERvd24uYWRkKHRoaXMub25JbnB1dERvd24sIHRoaXMpO1xuICAgIHRoaXMuaGVpZ2h0ID0gNjQ7XG4gICAgdGhpcy53aWR0aCA9IDY0O1xufTtcblxuTXVyeW9tYS5CbHVlcHJpbnRNZW51SXRlbS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKE11cnlvbWEuUHJlZmFiLnByb3RvdHlwZSk7XG5NdXJ5b21hLkJsdWVwcmludE1lbnVJdGVtLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuQmx1ZXByaW50TWVudUl0ZW07XG5cbk11cnlvbWEuQmx1ZXByaW50TWVudUl0ZW0ucHJvdG90eXBlLnNlbGVjdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBjb25zb2xlLmxvZygnQmx1ZXByaW50TWVudUl0ZW0gc2VsZWN0ZWQnKTtcbiAgICAvKlxuICAgIHZhciBlbmVteTtcbiAgICAvLyBnZXQgZW5lbXkgcHJlZmFiXG4gICAgZW5lbXkgPSB0aGlzLmdhbWVfc3RhdGUucHJlZmFic1t0aGlzLnRleHRdO1xuICAgIC8vIGF0dGFjayBzZWxlY3RlZCBlbmVteVxuICAgIHRoaXMuZ2FtZV9zdGF0ZS5jdXJyZW50X3VuaXQuYXR0YWNrKGVuZW15KTtcbiAgICAvLyBkaXNhYmxlIG1lbnVzXG4gICAgdGhpcy5nYW1lX3N0YXRlLnByZWZhYnMuZW5lbXlfdW5pdHNfbWVudS5kaXNhYmxlKCk7XG4gICAgdGhpcy5nYW1lX3N0YXRlLnByZWZhYnMucGxheWVyX3VuaXRzX21lbnUuZGlzYWJsZSgpO1xuICAgICovXG59O1xuXG5NdXJ5b21hLkJsdWVwcmludE1lbnVJdGVtLnByb3RvdHlwZS5vbklucHV0RG93biA9IGZ1bmN0aW9uICgpe1xuICAgIGNvbnNvbGUubG9nKCdCbHVlcHJpbnRNZW51SXRlbSBjbGlja2VkOiAnLCB0aGlzLm5hbWUpOyAgICAgXG4gICAgdGhpcy5nYW1lX3N0YXRlLnByZWZhYnMuaHVkX21lbnUuc2V0Q3VycmVudEJsdWVwcmludCh0aGlzKTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL2pzL3ByZWZhYnMvSFVEL0JsdWVwcmludE1lbnVJdGVtLmpzXG4gKiogbW9kdWxlIGlkID0gMTRcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInZhciBNdXJ5b21hID0gTXVyeW9tYSB8fCB7fTtcblxuTXVyeW9tYS5TaG93U3RhdCA9IGZ1bmN0aW9uIChnYW1lX3N0YXRlLCBuYW1lLCBwb3NpdGlvbiwgcHJvcGVydGllcykge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIE11cnlvbWEuVGV4dFByZWZhYi5jYWxsKHRoaXMsIGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKTtcbiAgICBcbiAgICB0aGlzLnByZWZhYiA9IHRoaXMuZ2FtZV9zdGF0ZS5wcmVmYWJzW3Byb3BlcnRpZXMucHJlZmFiXTtcbiAgICB0aGlzLnN0YXQgPSBwcm9wZXJ0aWVzLnN0YXQ7XG59O1xuXG5NdXJ5b21hLlNob3dTdGF0LnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTXVyeW9tYS5UZXh0UHJlZmFiLnByb3RvdHlwZSk7XG5NdXJ5b21hLlNob3dTdGF0LnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuU2hvd1N0YXQ7XG5cbk11cnlvbWEuU2hvd1N0YXQucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB0aGlzLnRleHQgPSB0aGlzLnByZWZhYi5zdGF0c1t0aGlzLnN0YXRdO1xufTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vanMvcHJlZmFicy9IVUQvU2hvd1N0YXQuanNcbiAqKiBtb2R1bGUgaWQgPSAxNVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwidmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xuXG5NdXJ5b21hLkFjdGlvbk1lc3NhZ2UgPSBmdW5jdGlvbiAoZ2FtZV9zdGF0ZSwgbmFtZSwgcG9zaXRpb24sIHByb3BlcnRpZXMpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBNdXJ5b21hLlByZWZhYi5jYWxsKHRoaXMsIGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKTtcbiAgICBcbiAgICB0aGlzLmFuY2hvci5zZXRUbygwLjUpO1xuICAgIFxuICAgIC8vIGNyZWF0ZSBtZXNzYWdlIHRleHRcbiAgICB0aGlzLm1lc3NhZ2VfdGV4dCA9IG5ldyBNdXJ5b21hLlRleHRQcmVmYWIodGhpcy5nYW1lX3N0YXRlLCB0aGlzLm5hbWUgKyBcIl9tZXNzYWdlXCIsIHBvc2l0aW9uLCB7Z3JvdXA6IFwiaHVkXCIsIHRleHQ6IHByb3BlcnRpZXMubWVzc2FnZSwgc3R5bGU6IE9iamVjdC5jcmVhdGUodGhpcy5nYW1lX3N0YXRlLlRFWFRfU1RZTEUpfSk7XG4gICAgdGhpcy5tZXNzYWdlX3RleHQuYW5jaG9yLnNldFRvKDAuNSk7XG4gICAgXG4gICAgLy8gc3RhcnQgdGltZXIgdG8gZGVzdHJveSB0aGUgbWVzc2FnZVxuICAgIHRoaXMua2lsbF90aW1lciA9IHRoaXMuZ2FtZV9zdGF0ZS5nYW1lLnRpbWUuY3JlYXRlKCk7XG4gICAgdGhpcy5raWxsX3RpbWVyLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogcHJvcGVydGllcy5kdXJhdGlvbiwgdGhpcy5raWxsLCB0aGlzKTtcbiAgICB0aGlzLmtpbGxfdGltZXIuc3RhcnQoKTtcbn07XG5cbk11cnlvbWEuQWN0aW9uTWVzc2FnZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKE11cnlvbWEuUHJlZmFiLnByb3RvdHlwZSk7XG5NdXJ5b21hLkFjdGlvbk1lc3NhZ2UucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTXVyeW9tYS5BY3Rpb25NZXNzYWdlO1xuXG5NdXJ5b21hLkFjdGlvbk1lc3NhZ2UucHJvdG90eXBlLmtpbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgUGhhc2VyLlNwcml0ZS5wcm90b3R5cGUua2lsbC5jYWxsKHRoaXMpO1xuICAgIC8vIHdoZW4gdGhlIG1lc3NhZ2UgaXMgZGVzdHJveWVkLCBjYWxsIG5leHQgdHVyblxuICAgIHRoaXMubWVzc2FnZV90ZXh0LmtpbGwoKTtcbiAgICB0aGlzLmdhbWVfc3RhdGUubmV4dF90dXJuKCk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9BY3Rpb25NZXNzYWdlLmpzXG4gKiogbW9kdWxlIGlkID0gMTZcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsIiAgICAvKiBNYXJrZXIgKi9cbiAgICAvKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4gICAgXG5cbiAgICB2YXIgTXVyeW9tYSA9IE11cnlvbWEgfHwge307XG5cbiAgICBNdXJ5b21hLk1hcmtlciA9IGZ1bmN0aW9uIChnYW1lX3N0YXRlLCBsYXllcikge1xuICAgICAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgICAgICB2YXIgbmFtZSA9ICdtYXJrZXInOyAgICBcbiAgICAgICAgdmFyIHBvc2l0aW9uID0ge3g6IDAsIHk6IDB9O1xuICAgICAgICB2YXIgaGVpZ2h0ID0gNjQ7XG4gICAgICAgIHZhciB3aWR0aCA9IDY0O1xuICAgICAgICBcbiAgICAgICAgLy8gY3JlYXRlIGEgbmV3IGJpdG1hcCBkYXRhIG9iamVjdFxuICAgICAgICB2YXIgYm1kID0gZ2FtZS5hZGQuYml0bWFwRGF0YSh3aWR0aCxoZWlnaHQpO1xuXG4gICAgICAgIC8vIGRyYXcgdG8gdGhlIGNhbnZhcyBjb250ZXh0IGxpa2Ugbm9ybWFsXG4gICAgICAgIGJtZC5jdHguYmVnaW5QYXRoKCk7XG4gICAgICAgIGJtZC5jdHgucmVjdCgwLDAsd2lkdGgsaGVpZ2h0KTtcbiAgICAgICAgLy9kZWJ1Z1xuICAgICAgICAvL2JtZC5jdHguZmlsbFN0eWxlID0gJyNFQUNBREQnOyAgICAgIFxuICAgICAgICAvL2JtZC5jdHguZmlsbCgpO1xuXG4gICAgICAgIHZhciBwcm9wZXJ0aWVzID0ge2dyb3VwOiAnaHVkJywgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCwgdGV4dHVyZTogYm1kfTtcblxuICAgICAgICBNdXJ5b21hLlByZWZhYi5jYWxsKHRoaXMsIGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKTsgICAgICAgXG4gICAgICAgIHRoaXMuaW5wdXRFbmFibGVkID0gdHJ1ZTsgXG4gICAgICAgIHRoaXMuaW5wdXQuYm91bmRzUmVjdCA9IGxheWVyO1xuICAgICAgICB0aGlzLmlucHV0LmVuYWJsZVNuYXAoMzIsIDMyLCB0cnVlLCB0cnVlKTtcbiAgICAgICAgdGhpcy5lbmFibGVCb2R5ID0gdHJ1ZTsgICAgICAgICAgICBcbiAgICB9O1xuXG4gICAgTXVyeW9tYS5NYXJrZXIucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShNdXJ5b21hLlByZWZhYi5wcm90b3R5cGUpO1xuICAgIE11cnlvbWEuTWFya2VyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuTWFya2VyO1xuICAgIE11cnlvbWEuTWFya2VyLnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbigpeyAgIFxuICAgICAgICB0aGlzLnggPSBsYXllci5nZXRUaWxlWChnYW1lLmlucHV0LmFjdGl2ZVBvaW50ZXIud29ybGRYKSAqIDMyO1xuICAgICAgICB0aGlzLnkgPSBsYXllci5nZXRUaWxlWShnYW1lLmlucHV0LmFjdGl2ZVBvaW50ZXIud29ybGRZKSAqIDMyOyAgICAgICAgICAgICAgICBcbiAgICB9O1xuXG4gICAgTXVyeW9tYS5NYXJrZXIucHJvdG90eXBlLmNvbGxpc2lvbkhhbmRsZXIgPSBmdW5jdGlvbihzcHJpdGUxLCBzcHJpdGUyKXsgICAgICAgICBcbiAgICAgICAgY29uc29sZS5sb2coJ2NvbGxpc2lvbiAnLCBzcHJpdGUxKTsgICAgICAgICAgICBcbiAgICB9XG5cbiAgICBNdXJ5b21hLk1hcmtlci5wcm90b3R5cGUuc2V0RGltZW5zaW9ucyA9IGZ1bmN0aW9uKGJsdWVwcmludCl7XG4gICAgICAgIC8vY29uc29sZS5sb2coJ2JsdWVwcmludCAnLCBibHVlcHJpbnQpO1xuICAgICAgICB0aGlzLnRleHR1cmUgPSBibHVlcHJpbnQudGV4dHVyZTsgICAgICAgIFxuICAgICAgICB0aGlzLmJvZHkgPSBibHVlcHJpbnQuYm9keTsgICAgICAgXG4gICAgICAgIHRoaXMuYWxwaGEgPSAwLjU7XG4gICAgfVxuICAgIC8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9NYXJrZXIuanNcbiAqKiBtb2R1bGUgaWQgPSAxN1xuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwidmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xuXG5NdXJ5b21hLlN0YXRNYW5hZ2VyID0gZnVuY3Rpb24gKGdhbWVfc3RhdGUsIG5hbWUsIHBvc2l0aW9uLCBwcm9wZXJ0aWVzKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgTXVyeW9tYS5QcmVmYWIuY2FsbCh0aGlzLCBnYW1lX3N0YXRlLCBuYW1lLCBwb3NpdGlvbiwgcHJvcGVydGllcyk7ICAgIFxuICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOyBcbiAgXHR2YXIgZGF0YSA9IFtdO1xuXG4gICAgdGhpcy5teWRhdGEgPSBnYW1lLmFkZC50ZXh0KHBvc2l0aW9uLngsIHBvc2l0aW9uLnksICcnLCBPYmplY3QuY3JlYXRlKGdhbWVfc3RhdGUuVEVYVF9TVFlMRSkpO1xuICAgIHRoaXMubXlkYXRhLnBhcnNlTGlzdChkYXRhKTtcblxuICAgIGdhbWUudGltZS5ldmVudHMubG9vcChQaGFzZXIuVGltZXIuU0VDT05ELCB1cGRhdGVDb3VudGVyLCB0aGlzKTtcbiAgICB0aGlzLmNvdW50ZXIgPSAwO1xuXG5cbiAgICB0aGlzLnBvcHVsYXRpb24gPSAwOyAvL3RvdGFsIHBvcHVsYXRpb25cbiAgICB0aGlzLnN1cHBseVNwYWNlID0gMDsgLy9zcGFjZSBuZWVkZWQgZm9yIHRoZSBwb3B1bGF0aW9uXG5cbn07XG5cbmZ1bmN0aW9uIHVwZGF0ZUNvdW50ZXIoKSB7XG4gICAgdGhpcy5jb3VudGVyKys7ICAgIFxufVxuXG5NdXJ5b21hLlN0YXRNYW5hZ2VyLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoTXVyeW9tYS5UZXh0UHJlZmFiLnByb3RvdHlwZSk7XG5NdXJ5b21hLlN0YXRNYW5hZ2VyLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuU3RhdE1hbmFnZXI7XG5cbk11cnlvbWEuU3RhdE1hbmFnZXIucHJvdG90eXBlLnVwZGF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjsgXG5cbiAgICB2YXIgZGF0YSA9IFtcbiAgICBcdFsgJ1RpbWUnLCB0aGlzLmNvdW50ZXIgLCAnJywgJycgXSwgICAgICAgIFxuICAgICAgICBbICdQb3B1bGF0aW9uJywgdGhpcy5wb3B1bGF0aW9uLCAnJywgJycgXSxcbiAgICAgICAgWyAnU3VwcGx5JywgdGhpcy5zdXBwbHlTcGFjZSwgJycsICcnIF0sICAgICAgICBcbiAgICAgICAgXG4gICAgXTtcbiAgIHRoaXMubXlkYXRhLnBhcnNlTGlzdChkYXRhKTtcbn07XG5cblxuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9wcmVmYWJzL0hVRC9TdGF0TWFuYWdlci5qc1xuICoqIG1vZHVsZSBpZCA9IDE4XG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJ2YXIgTXVyeW9tYSA9IE11cnlvbWEgfHwge307XG5cbk11cnlvbWEuQm9vdFN0YXRlID0gZnVuY3Rpb24gKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFBoYXNlci5TdGF0ZS5jYWxsKHRoaXMpO1xufTtcblxuTXVyeW9tYS5Cb290U3RhdGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZShQaGFzZXIuU3RhdGUucHJvdG90eXBlKTtcbk11cnlvbWEuQm9vdFN0YXRlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuQm9vdFN0YXRlO1xuXG5NdXJ5b21hLkJvb3RTdGF0ZS5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uIChsZXZlbF9maWxlLCBuZXh0X3N0YXRlKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdGhpcy5sZXZlbF9maWxlID0gbGV2ZWxfZmlsZTtcbiAgICB0aGlzLm5leHRfc3RhdGUgPSBuZXh0X3N0YXRlO1xufTtcblxuTXVyeW9tYS5Cb290U3RhdGUucHJvdG90eXBlLnByZWxvYWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdGhpcy5sb2FkLnRleHQoXCJsZXZlbDFcIiwgdGhpcy5sZXZlbF9maWxlKTtcbn07XG5cbk11cnlvbWEuQm9vdFN0YXRlLnByb3RvdHlwZS5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIGxldmVsX3RleHQsIGxldmVsX2RhdGE7XG4gICAgbGV2ZWxfdGV4dCA9IHRoaXMuZ2FtZS5jYWNoZS5nZXRUZXh0KFwibGV2ZWwxXCIpO1xuICAgIGxldmVsX2RhdGEgPSBKU09OLnBhcnNlKGxldmVsX3RleHQpOyAgICBcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQoXCJMb2FkaW5nU3RhdGVcIiwgdHJ1ZSwgZmFsc2UsIGxldmVsX2RhdGEsIHRoaXMubmV4dF9zdGF0ZSk7XG59O1xuXG5cbi8qKioqKioqKioqKioqKioqKlxuICoqIFdFQlBBQ0sgRk9PVEVSXG4gKiogLi9qcy9zdGF0ZXMvQm9vdFN0YXRlLmpzXG4gKiogbW9kdWxlIGlkID0gMTlcbiAqKiBtb2R1bGUgY2h1bmtzID0gMFxuICoqLyIsInZhciBNdXJ5b21hID0gTXVyeW9tYSB8fCB7fTtcblxuTXVyeW9tYS5Mb2FkaW5nU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgUGhhc2VyLlN0YXRlLmNhbGwodGhpcyk7XG59O1xuXG5NdXJ5b21hLkxvYWRpbmdTdGF0ZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TdGF0ZS5wcm90b3R5cGUpO1xuTXVyeW9tYS5Mb2FkaW5nU3RhdGUucHJvdG90eXBlLmNvbnN0cnVjdG9yID0gTXVyeW9tYS5Mb2FkaW5nU3RhdGU7XG5cbk11cnlvbWEuTG9hZGluZ1N0YXRlLnByb3RvdHlwZS5pbml0ID0gZnVuY3Rpb24gKGxldmVsX2RhdGEsIG5leHRfc3RhdGUpIHsgXG5cbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB0aGlzLmxldmVsX2RhdGEgPSBsZXZlbF9kYXRhO1xuICAgIHRoaXMubmV4dF9zdGF0ZSA9IG5leHRfc3RhdGU7XG59O1xuXG5NdXJ5b21hLkxvYWRpbmdTdGF0ZS5wcm90b3R5cGUucHJlbG9hZCA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB2YXIgYXNzZXRzLCBhc3NldF9sb2FkZXIsIGFzc2V0X2tleSwgYXNzZXQ7XG4gICAgYXNzZXRzID0gdGhpcy5sZXZlbF9kYXRhLmFzc2V0cztcbiAgICBmb3IgKGFzc2V0X2tleSBpbiBhc3NldHMpIHsgLy8gbG9hZCBhc3NldHMgYWNjb3JkaW5nIHRvIGFzc2V0IGtleVxuICAgICAgICBpZiAoYXNzZXRzLmhhc093blByb3BlcnR5KGFzc2V0X2tleSkpIHtcbiAgICAgICAgICAgIGFzc2V0ID0gYXNzZXRzW2Fzc2V0X2tleV07XG4gICAgICAgICAgICBzd2l0Y2ggKGFzc2V0LnR5cGUpIHtcbiAgICAgICAgICAgIGNhc2UgXCJpbWFnZVwiOlxuICAgICAgICAgICAgICAgIHRoaXMubG9hZC5pbWFnZShhc3NldF9rZXksIGFzc2V0LnNvdXJjZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwic3ByaXRlc2hlZXRcIjpcbiAgICAgICAgICAgICAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoYXNzZXRfa2V5LCBhc3NldC5zb3VyY2UsIGFzc2V0LmZyYW1lX3dpZHRoLCBhc3NldC5mcmFtZV9oZWlnaHQsIGFzc2V0LmZyYW1lcywgYXNzZXQubWFyZ2luLCBhc3NldC5zcGFjaW5nKTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgXCJ0aWxlbWFwXCI6XG4gICAgICAgICAgICAgICAgdGhpcy5sb2FkLnRpbGVtYXAoYXNzZXRfa2V5LCBhc3NldC5zb3VyY2UsIG51bGwsIFBoYXNlci5UaWxlbWFwLlRJTEVEX0pTT04pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcblxuTXVyeW9tYS5Mb2FkaW5nU3RhdGUucHJvdG90eXBlLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQodGhpcy5uZXh0X3N0YXRlLCB0cnVlLCBmYWxzZSwgdGhpcy5sZXZlbF9kYXRhKTtcbn07XG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL2pzL3N0YXRlcy9Mb2FkaW5nU3RhdGUuanNcbiAqKiBtb2R1bGUgaWQgPSAyMFxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiY29uc29sZS5sb2coJ01hbmFnZVN0YXRlJyk7XG52YXIgTXVyeW9tYSA9IE11cnlvbWEgfHwge307XG5cbk11cnlvbWEuTWFuYWdlU3RhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgUGhhc2VyLlN0YXRlLmNhbGwodGhpcyk7XG4gICAgXG4gICAgdGhpcy5wcmVmYWJfY2xhc3NlcyA9IHtcbiAgICAgICAgXCJiYWNrZ3JvdW5kXCI6IE11cnlvbWEuVGlsZVByZWZhYi5wcm90b3R5cGUuY29uc3RydWN0b3IsXG4gICAgICAgIFwicmVjdGFuZ2xlXCI6IE11cnlvbWEuUHJlZmFiLnByb3RvdHlwZS5jb25zdHJ1Y3RvciwgICAgICAgIFxuICAgICAgICBcImJsdWVwcmludFwiOiBNdXJ5b21hLkJsdWVwcmludC5wcm90b3R5cGUuY29uc3RydWN0b3JcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuVEVYVF9TVFlMRSA9IHtmb250OiBcIjE0cHggQXJpYWxcIiwgZmlsbDogXCIjOWE3YjZlXCJ9O1xuXG4gICAgdGhpcy5TSE9SVF9USU1FID0gMzAwMDtcbiAgICB0aGlzLk1FRElVTV9USU1FID0gdGhpcy5TSE9SVF9USU1FICogMjtcbiAgICB0aGlzLkxPTkdfVElNRSA9IHRNRURJVU1fVElNRSAqIDI7XG59O1xuXG5NdXJ5b21hLk1hbmFnZVN0YXRlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoUGhhc2VyLlN0YXRlLnByb3RvdHlwZSk7XG5NdXJ5b21hLk1hbmFnZVN0YXRlLnByb3RvdHlwZS5jb25zdHJ1Y3RvciA9IE11cnlvbWEuTWFuYWdlU3RhdGU7XG5cbk11cnlvbWEuTWFuYWdlU3RhdGUucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbiAobGV2ZWxfZGF0YSkge1xuICAgIC8vY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0nKTtcbiAgICAvL2NvbnNvbGUubG9nKCdNYW5hZ2VTdGF0ZSBpbml0Jyk7XG4gICAgXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdGhpcy5sZXZlbF9kYXRhID0gbGV2ZWxfZGF0YTsgICAgXG4gICAgdGhpcy5zY2FsZS5zY2FsZU1vZGUgPSBQaGFzZXIuU2NhbGVNYW5hZ2VyLlNIT1dfQUxMO1xuICAgIHRoaXMuc2NhbGUucGFnZUFsaWduSG9yaXpvbnRhbGx5ID0gdHJ1ZTtcbiAgICB0aGlzLnNjYWxlLnBhZ2VBbGlnblZlcnRpY2FsbHkgPSB0cnVlO1xufTtcblxuTXVyeW9tYS5NYW5hZ2VTdGF0ZS5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xuICAgIC8vY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0nKTtcbiAgICAvL2NvbnNvbGUubG9nKCdNYW5hZ2VTdGF0ZSBjcmVhdGUnKTsgICBcblxuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIHZhciBncm91cF9uYW1lLCBwcmVmYWJfbmFtZSwgcGxheWVyX3VuaXRfbmFtZSwgZW5lbXlfdW5pdF9uYW1lLCBsYXllciwgYnVpbGRpbmdzO1xuICAgIFxuICAgIHRoaXMuc2hvd19iYWNrZ3JvdW5kKCk7XG4gICAgXG5cbiAgICAvLyBjcmVhdGUgZ3JvdXBzXG4gICAgdGhpcy5ncm91cHMgPSB7fTtcbiAgICB0aGlzLmxldmVsX2RhdGEuZ3JvdXBzLmZvckVhY2goZnVuY3Rpb24gKGdyb3VwX25hbWUpIHsgICAgICAgIFxuICAgICAgICB0aGlzLmdyb3Vwc1tncm91cF9uYW1lXSA9IHRoaXMuZ2FtZS5hZGQuZ3JvdXAoKTtcbiAgICB9LCB0aGlzKTsgIFxuXG4gICAgLy8gY3JlYXRlIHByZWZhYnNcbiAgICB0aGlzLnByZWZhYnMgPSB7fTtcbiAgICBmb3IgKHByZWZhYl9uYW1lIGluIHRoaXMubGV2ZWxfZGF0YS5wcmVmYWJzKSB7ICAgICAgICBcbiAgICAgICAgaWYgKHRoaXMubGV2ZWxfZGF0YS5wcmVmYWJzLmhhc093blByb3BlcnR5KHByZWZhYl9uYW1lKSkge1xuICAgICAgICAgICAgLy8gY3JlYXRlIHByZWZhYlxuICAgICAgICAgICAgdGhpcy5jcmVhdGVfcHJlZmFiKHByZWZhYl9uYW1lLCB0aGlzLmxldmVsX2RhdGEucHJlZmFic1twcmVmYWJfbmFtZV0pO1xuICAgICAgICB9XG4gICAgfTsgICAgXG5cbiAgICAvL3RoaXMuYWRkX21pbmluZ19wb2ludHMoKTtcbiAgICBcbiAgICB0aGlzLmluaXRfaHVkKCk7ICAgIFxuICAgIC8vIGNyZWF0ZSB1bml0cyBhcnJheSB3aXRoIHBsYXllciBhbmQgZW5lbXkgdW5pdHNcbiAgICB0aGlzLnVuaXRzID0gW107XG4gICAgLy90aGlzLnVuaXRzID0gdGhpcy51bml0cy5jb25jYXQodGhpcy5ncm91cHMucGxheWVyX3VuaXRzLmNoaWxkcmVuKTtcbiAgICAvL3RoaXMudW5pdHMgPSB0aGlzLnVuaXRzLmNvbmNhdCh0aGlzLmdyb3Vwcy5lbmVteV91bml0cy5jaGlsZHJlbik7XG4gICAgdGhpcy51bml0cyA9IHRoaXMudW5pdHMuY29uY2F0KHRoaXMuZ3JvdXBzLmh1ZC5jaGlsZHJlbik7ICAgICAgICBcbiAgICAvL3RoaXMubmV4dF90dXJuKCk7XG59O1xuXG5NdXJ5b21hLk1hbmFnZVN0YXRlLnByb3RvdHlwZS5jcmVhdGVfcHJlZmFiID0gZnVuY3Rpb24gKHByZWZhYl9uYW1lLCBwcmVmYWJfZGF0YSkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIC8qXG4gICAgY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0nKTtcbiAgICBjb25zb2xlLmxvZygnTWFuYWdlU3RhdGUgY3JlYXRlJyk7XG4gICAgY29uc29sZS5sb2coJ3ByZWZhYl9uYW1lICcsIHByZWZhYl9uYW1lKTtcbiAgICBjb25zb2xlLmxvZygncHJlZmFiX2RhdGEgJywgcHJlZmFiX2RhdGEpO1xuICAgICovICAgIFxuXG4gICAgdmFyIHByZWZhYjtcbiAgICAvLyBjcmVhdGUgb2JqZWN0IGFjY29yZGluZyB0byBpdHMgdHlwZVxuICAgIGlmICh0aGlzLnByZWZhYl9jbGFzc2VzLmhhc093blByb3BlcnR5KHByZWZhYl9kYXRhLnR5cGUpKSB7XG4gICAgICAgIHByZWZhYiA9IG5ldyB0aGlzLnByZWZhYl9jbGFzc2VzW3ByZWZhYl9kYXRhLnR5cGVdKHRoaXMsIHByZWZhYl9uYW1lLCBwcmVmYWJfZGF0YS5wb3NpdGlvbiwgcHJlZmFiX2RhdGEucHJvcGVydGllcyk7XG4gICAgfVxufTtcblxuTXVyeW9tYS5NYW5hZ2VTdGF0ZS5wcm90b3R5cGUuaW5pdF9odWQgPSBmdW5jdGlvbiAoKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIHVuaXRfaW5kZXgsIHBsYXllcl91bml0X2hlYWx0aCwgYnVpbGRfYXJlYSwgc3RhdF9tYW5hZ2VyO1xuXG4gICAgLy8gc2hvdyBwbGF5ZXIgYWN0aW9uc1xuICAgIC8vdGhpcy5zaG93X3BsYXllcl9hY3Rpb25zKHt4OiAxMDYsIHk6IDIxMH0pO1xuICAgIFxuICAgIC8vIHNob3cgcGxheWVyIHVuaXRzXG4gICAgLy90aGlzLnNob3dfdW5pdHMoXCJwbGF5ZXJfdW5pdHNcIiwge3g6IDIwMiwgeTogMjEwfSwgTXVyeW9tYS5QbGF5ZXJNZW51SXRlbS5wcm90b3R5cGUuY29uc3RydWN0b3IpO1xuICAgIFxuICAgIC8vIHNob3cgZW5lbXkgdW5pdHNcbiAgICAvL3RoaXMuc2hvd191bml0cyhcImVuZW15X3VuaXRzXCIsIHt4OiAxMCwgeTogMjEwfSwgTXVyeW9tYS5FbmVteU1lbnVJdGVtLnByb3RvdHlwZS5jb25zdHJ1Y3Rvcik7ICBcblxuICAgIC8vIHNob3cgYmx1ZXByaW50c1xuICAgIHRoaXMuc2hvd19ibHVlcHJpbnRzKFwiaHVkXCIsIHt4OiAxMCwgeTogNjYwfSwgTXVyeW9tYS5CbHVlcHJpbnRNZW51SXRlbS5wcm90b3R5cGUuY29uc3RydWN0b3IpO1xuICAgIC8vdGhpcy5jcmVhdGVfc3RhdHMoXCJodWRcIiwge3g6IDI5MCwgeTogNjY1fSwgTXVyeW9tYS5CbHVlcHJpbnRNZW51SXRlbS5wcm90b3R5cGUuY29uc3RydWN0b3IpO1xuICAgIHN0YXRfbWFuYWdlciA9IG5ldyBNdXJ5b21hLlN0YXRNYW5hZ2VyKHRoaXMsIFwic3RhdF9tYW5hZ2VyXCIsIHt4OiAyOTAsIHk6IDY2NX0sIHtncm91cDogXCJodWRcIn0pXG4gICAgYnVpbGRfYXJlYSA9IG5ldyBNdXJ5b21hLkJ1aWxkQXJlYSh0aGlzLCBsYXllcik7ICAgICAgXG5cbn07XG5cbk11cnlvbWEuTWFuYWdlU3RhdGUucHJvdG90eXBlLnNob3dfYmx1ZXByaW50cyA9IGZ1bmN0aW9uIChncm91cF9uYW1lLCBwb3NpdGlvbiwgbWVudV9pdGVtX2NvbnN0cnVjdG9yKSB7ICAgIFxuICAgIFwidXNlIHN0cmljdFwiOyAgICBcblxuICAgIC8vY29uc29sZS5sb2coJy0tLS0tLS0tLS0tLS0tLS0tLS0tLScpO1xuICAgIC8vY29uc29sZS5sb2coJ2dyb3VwX25hbWUgJywgZ3JvdXBfbmFtZSk7XG4gICAgLy9jb25zb2xlLmxvZygndGhpcy5ncm91cHMgJywgdGhpcy5ncm91cHMpO1xuICAgIHZhciBicF9pbmRleCwgbWVudV9pdGVtcywgYnBfbWVudV9pdGVtLCBicF9tZW51O1xuICAgIFxuICAgIGJwX2luZGV4ID0gMDtcbiAgICBtZW51X2l0ZW1zID0gW107IFxuXG4gICAgZm9yICh2YXIga2V5IGluIHRoaXMubGV2ZWxfZGF0YS5icCkge1xuICAgICAgICB2YXIgaXRlbSA9IHRoaXMubGV2ZWxfZGF0YS5icFtrZXldO1xuICAgICAgICBicF9tZW51X2l0ZW0gPSBuZXcgbWVudV9pdGVtX2NvbnN0cnVjdG9yKHRoaXMsIGtleSArIFwiX21lbnVfaXRlbVwiLCB7eDogcG9zaXRpb24ueCArIGJwX2luZGV4ICogODAsIHk6IHBvc2l0aW9uLnkgKyA1fSwge2dyb3VwOiBcImh1ZFwiLCB0ZXh0OiBrZXksIHRleHR1cmU6IGl0ZW0ucHJvcGVydGllcy50ZXh0dXJlfSk7XG4gICAgICAgIGJwX2luZGV4ICs9IDE7XG4gICAgICAgIG1lbnVfaXRlbXMucHVzaChicF9tZW51X2l0ZW0pO1xuICAgIH0gIFxuXG4gICAgYnBfbWVudSA9IG5ldyBNdXJ5b21hLkJsdWVwcmludE1lbnUodGhpcywgZ3JvdXBfbmFtZSArIFwiX21lbnVcIiwgcG9zaXRpb24sIHtncm91cDogXCJodWRcIiwgbWVudV9pdGVtczogbWVudV9pdGVtc30pOyAgICBcbiAgICBcbn07XG5cbk11cnlvbWEuTWFuYWdlU3RhdGUucHJvdG90eXBlLnNob3dfYmFja2dyb3VuZCA9IGZ1bmN0aW9uKCkge1xuICAgIFxuICAgdmFyIG1hcDtcbiAgIHZhciBkYXRhID0gJyc7ICBcblxuICAgIGZvciAodmFyIHkgPSAwOyB5IDwgNTA7IHkrKyl7XG4gICAgICAgIGZvciAodmFyIHggPSAwOyB4IDwgNTA7IHgrKyl7XG4gICAgICAgICAgICAvL2RhdGEgKz0gdGhpcy5nYW1lLnJuZC5iZXR3ZWVuKDAsIDQpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICBkYXRhICs9IDAgLy91bmRlcmRhcmtcbiAgICAgICAgICAgIGlmICh4IDwgNDkpe1xuICAgICAgICAgICAgICAgIGRhdGEgKz0gJywnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGlmICh5IDwgNDkpe1xuICAgICAgICAgICAgZGF0YSArPSBcIlxcblwiO1xuICAgICAgICB9XG4gICAgfSAgICAgICAgICAgICAgICAgIFxuXG4gICAgdGhpcy5nYW1lLmNhY2hlLmFkZFRpbGVtYXAoJ2R5bmFtaWNNYXAnLCBudWxsLCBkYXRhLCBQaGFzZXIuVGlsZW1hcC5DU1YpO1xuXG4gICAgLy8gIENyZWF0ZSBvdXIgbWFwICh0aGUgMzJ4MzIgaXMgdGhlIHRpbGUgc2l6ZSkgICAgICAgIFxuICAgIG1hcCA9IHRoaXMuZ2FtZS5hZGQudGlsZW1hcCgnZHluYW1pY01hcCcsIDMyLCAzMik7XG5cbiAgICAvLyAgJ3RpbGVzJyA9IGNhY2hlIGltYWdlIGtleSwgMzJ4MzIgPSB0aWxlIHNpemVcbiAgICAvL21hcC5hZGRUaWxlc2V0SW1hZ2UoJ2dyb3VuZF8xeDEnLCAnZ3JvdW5kXzF4MScsIDMyLCAzMik7XG4gICAgbWFwLmFkZFRpbGVzZXRJbWFnZSgnZGFya2NhdmUnLCAnZGFya2NhdmUnLCAzMiwgMzIpO1xuXG4gICAgLy8gIDAgaXMgaW1wb3J0YW50XG4gICAgLy9sYXllciA9IG1hcC5jcmVhdGVMYXllcigwKTsgIFxuICAgIGxheWVyID0gbWFwLmNyZWF0ZUxheWVyKDAsIDEwMjQsIDY0OCk7ICBcbiAgICBsYXllci5yZXNpemVXb3JsZCgpO1xufTtcblxuXG5NdXJ5b21hLk1hbmFnZVN0YXRlLnByb3RvdHlwZS5hZGRfbWluaW5nX3BvaW50cyA9IGZ1bmN0aW9uKCl7XG5cbiAgICAvKiBjb25zdCAqL1xuICAgIHZhciBOUl9NSU5JTkdfUE9JTlRTID0gNTsgICAgXG4gICAgdmFyIFdPUkxEX0hFSUdIVCA9IDgwMDtcbiAgICB2YXIgV09STERfV0lEVEggPSA2MDA7XG5cbiAgICAvKiBNaW5pbmcgcG9pbnRzICovXG4gICAgXG4gICAgdmFyIHJlc291cmNlcyA9IHRoaXMuZ2FtZS5hZGQucGh5c2ljc0dyb3VwKFBoYXNlci5QaHlzaWNzLkFSQ0FERSk7XG4gICAgY29uc29sZS5sb2coJ2dhbWVzdGF0ZSAnLCB0aGlzKTtcbiAgICB0aGlzLmdyb3Vwc1sncmVzb3VyY2VzJ10gPSByZXNvdXJjZXM7XG5cbiAgICBcbiAgICB2YXIgaSwgeCwgeTtcbiAgICBmb3IoaSA9IDA7IGkgPCBOUl9NSU5JTkdfUE9JTlRTOyBpKyspIHsgICAgICAgICAgICBcbiAgICAgICAgeCA9IHJhbmRTdGVwKDAsIFdPUkxEX1dJRFRIIC0gOTYsIDMyKTsgICAgXG4gICAgICAgIHkgPSByYW5kU3RlcCgwLCBXT1JMRF9IRUlHSFQgLSAxOTIgLCAzMik7ICAgICAgIFxuICAgICAgICBuZXcgTXVyeW9tYS5NaW5pbmdQb2ludCh0aGlzLCB7eDogeCwgeTogeX0pO1xuXG4gICAgfSAgXG4gICAgcmVzb3VyY2VzLnNldEFsbCgnYm9keS5jb2xsaWRlV29ybGRCb3VuZHMnLCB0cnVlKTsgIFxuICAgIHJlc291cmNlcy5zZXRBbGwoJ2JvZHkuaW1tb3ZhYmxlJywgdHJ1ZSk7XG4gICAgXG4gICAgLyogZ2V0IHJhbmRvbSBudW1iZXIgYXQgZGVmaW5pdGUgc3RlcCwgdXNlZCBmb3IgZ3JpZCBjb29yZGluYXRlcyBhdCBzdGVwIG9mIDMycHgqLyAgICAgICAgXG4gICAgZnVuY3Rpb24gcmFuZFN0ZXAobWluLCBtYXgsIHN0ZXApIHtcbiAgICAgICAgcmV0dXJuIG1pbiArIChzdGVwICogTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKihtYXgtbWluKS9zdGVwKSApO1xuICAgIH1cblxufVxuXG5cbk11cnlvbWEuTWFuYWdlU3RhdGUucHJvdG90eXBlLnNob3dfdW5pdHMgPSBmdW5jdGlvbiAoZ3JvdXBfbmFtZSwgcG9zaXRpb24sIG1lbnVfaXRlbV9jb25zdHJ1Y3Rvcikge1xuICAgIC8qXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgdmFyIHVuaXRfaW5kZXgsIG1lbnVfaXRlbXMsIHVuaXRfbWVudV9pdGVtLCB1bml0c19tZW51O1xuXG4gICAgLy8gY3JlYXRlIHVuaXRzIG1lbnUgaXRlbXNcbiAgICB1bml0X2luZGV4ID0gMDtcbiAgICBtZW51X2l0ZW1zID0gW107XG4gICAgdGhpcy5ncm91cHNbZ3JvdXBfbmFtZV0uZm9yRWFjaChmdW5jdGlvbiAodW5pdCkge1xuICAgICAgICB1bml0X21lbnVfaXRlbSA9IG5ldyBtZW51X2l0ZW1fY29uc3RydWN0b3IodGhpcywgdW5pdC5uYW1lICsgXCJfbWVudV9pdGVtXCIsIHt4OiBwb3NpdGlvbi54LCB5OiBwb3NpdGlvbi55ICsgdW5pdF9pbmRleCAqIDIwfSwge2dyb3VwOiBcImh1ZFwiLCB0ZXh0OiB1bml0Lm5hbWUsIHN0eWxlOiBPYmplY3QuY3JlYXRlKHRoaXMuVEVYVF9TVFlMRSl9KTtcbiAgICAgICAgdW5pdF9pbmRleCArPSAxO1xuICAgICAgICBtZW51X2l0ZW1zLnB1c2godW5pdF9tZW51X2l0ZW0pO1xuICAgIH0sIHRoaXMpO1xuICAgIC8vIGNyZWF0ZSB1bml0cyBtZW51XG4gICAgdW5pdHNfbWVudSA9IG5ldyBNdXJ5b21hLk1lbnUodGhpcywgZ3JvdXBfbmFtZSArIFwiX21lbnVcIiwgcG9zaXRpb24sIHtncm91cDogXCJodWRcIiwgbWVudV9pdGVtczogbWVudV9pdGVtc30pOyAgICAgIFxuICAgICovXG59O1xuXG5NdXJ5b21hLk1hbmFnZVN0YXRlLnByb3RvdHlwZS5zaG93X3BsYXllcl9hY3Rpb25zID0gZnVuY3Rpb24gKHBvc2l0aW9uKSB7XG4gICAgLypcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICB2YXIgYWN0aW9ucywgYWN0aW9uc19tZW51X2l0ZW1zLCBhY3Rpb25faW5kZXgsIGFjdGlvbnNfbWVudTtcbiAgICAvLyBhdmFpbGFibGUgYWN0aW9uc1xuICAgIGFjdGlvbnMgPSBbe3RleHQ6IFwiQXR0YWNrXCIsIGl0ZW1fY29uc3RydWN0b3I6IE11cnlvbWEuQXR0YWNrTWVudUl0ZW0ucHJvdG90eXBlLmNvbnN0cnVjdG9yfV07XG4gICAgYWN0aW9uc19tZW51X2l0ZW1zID0gW107XG4gICAgYWN0aW9uX2luZGV4ID0gMDtcbiAgICAvLyBjcmVhdGUgYSBtZW51IGl0ZW0gZm9yIGVhY2ggYWN0aW9uXG4gICAgYWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uIChhY3Rpb24pIHtcbiAgICAgICAgYWN0aW9uc19tZW51X2l0ZW1zLnB1c2gobmV3IGFjdGlvbi5pdGVtX2NvbnN0cnVjdG9yKHRoaXMsIGFjdGlvbi50ZXh0ICsgXCJfbWVudV9pdGVtXCIsIHt4OiBwb3NpdGlvbi54LCB5OiBwb3NpdGlvbi55ICsgYWN0aW9uX2luZGV4ICogMjB9LCB7Z3JvdXA6IFwiaHVkXCIsIHRleHQ6IGFjdGlvbi50ZXh0LCBzdHlsZTogT2JqZWN0LmNyZWF0ZSh0aGlzLlRFWFRfU1RZTEUpfSkpO1xuICAgICAgICBhY3Rpb25faW5kZXggKz0gMTtcbiAgICB9LCB0aGlzKTtcbiAgICBhY3Rpb25zX21lbnUgPSBuZXcgTXVyeW9tYS5NZW51KHRoaXMsIFwiYWN0aW9uc19tZW51XCIsIHBvc2l0aW9uLCB7Z3JvdXA6IFwiaHVkXCIsIG1lbnVfaXRlbXM6IGFjdGlvbnNfbWVudV9pdGVtc30pO1xuICAgICovXG59O1xuXG5NdXJ5b21hLk1hbmFnZVN0YXRlLnByb3RvdHlwZS5uZXh0X3R1cm4gPSBmdW5jdGlvbiAoKSB7XG4gICAgLypcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICAvLyB0YWtlcyB0aGUgbmV4dCB1bml0XG4gICAgdGhpcy5jdXJyZW50X3VuaXQgPSB0aGlzLnVuaXRzLnNoaWZ0KCk7XG4gICAgLy8gaWYgdGhlIHVuaXQgaXMgYWxpdmUsIGl0IGFjdHMsIG90aGVyd2lzZSBnb2VzIHRvIHRoZSBuZXh0IHR1cm5cbiAgICBpZiAodGhpcy5jdXJyZW50X3VuaXQuYWxpdmUpIHtcbiAgICAgICAgdGhpcy5jdXJyZW50X3VuaXQuYWN0KCk7XG4gICAgICAgIHRoaXMudW5pdHMucHVzaCh0aGlzLmN1cnJlbnRfdW5pdCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5uZXh0X3R1cm4oKTtcbiAgICB9XG4gICAgKi9cbn07XG5cbk11cnlvbWEuTWFuYWdlU3RhdGUucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKCl7XG4gICAgLypcbiAgICBnYW1lLmRlYnVnLmNhbWVyYUluZm8oZ2FtZS5jYW1lcmEsIDMyLCAzMik7ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAqL1xuICAgIGZvciAodmFyIGdyb3VwIGluIHRoaXMuZ3JvdXBzKXsgICAgICAgICAgICAgICAgXG4gICAgICAgICBnYW1lLmRlYnVnLmJvZHkoZ3JvdXApO1xuICAgIH0gXG59XG5cblxuXG5cblxuXG5cblxuLyoqKioqKioqKioqKioqKioqXG4gKiogV0VCUEFDSyBGT09URVJcbiAqKiAuL2pzL3N0YXRlcy9NYW5hZ2VTdGF0ZS5qc1xuICoqIG1vZHVsZSBpZCA9IDIxXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iLCJhbGVydCgnTWFpbicpO1xudmFyIE11cnlvbWEgPSBNdXJ5b21hIHx8IHt9O1xudmFyIGdhbWUgPSBuZXcgUGhhc2VyLkdhbWUoMTAyNCwgNzY4LCBQaGFzZXIuQ0FOVkFTKTtcbmdhbWUuc3RhdGUuYWRkKFwiQm9vdFN0YXRlXCIsIG5ldyBNdXJ5b21hLkJvb3RTdGF0ZSgpKTtcbmdhbWUuc3RhdGUuYWRkKFwiTG9hZGluZ1N0YXRlXCIsIG5ldyBNdXJ5b21hLkxvYWRpbmdTdGF0ZSgpKTtcbmdhbWUuc3RhdGUuYWRkKFwiTWFuYWdlU3RhdGVcIiwgbmV3IE11cnlvbWEuTWFuYWdlU3RhdGUoKSk7XG5nYW1lLnN0YXRlLnN0YXJ0KFwiQm9vdFN0YXRlXCIsIHRydWUsIGZhbHNlLCBcImFzc2V0cy9sZXZlbHMvbWFuYWdlLmpzb25cIiwgXCJNYW5hZ2VTdGF0ZVwiKTtcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIC4vanMvbWFpbi5qc1xuICoqIG1vZHVsZSBpZCA9IDIyXG4gKiogbW9kdWxlIGNodW5rcyA9IDBcbiAqKi8iXSwic291cmNlUm9vdCI6IiJ9